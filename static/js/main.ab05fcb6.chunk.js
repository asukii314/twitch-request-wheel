(this["webpackJsonptwitch-bot"]=this["webpackJsonptwitch-bot"]||[]).push([[0],{129:function(e,t){},221:function(e,t,a){},225:function(e,t,a){},238:function(e,t){},249:function(e,t,a){},250:function(e,t,a){},251:function(e,t,a){},252:function(e,t,a){},256:function(e,t,a){},258:function(e,t,a){},263:function(e,t,a){},264:function(e,t,a){},265:function(e,t,a){},267:function(e,t,a){},268:function(e,t,a){},270:function(e,t,a){"use strict";a.r(t);var n=a(15),s=a(13),r=a(17),o=a(18),i=a(16),c=a(25),l=a(7),d=a(0),u=a.n(d),m=a(12),h=a(11),p=a(3),b=a(290),g=a(131),f=a(51),j=1,v=2,O=3,y=function(){function e(t){var a=this;Object(n.a)(this,e),this.updateLastMessageTime=function(e){a.lastMessageTimes=Object(p.a)(Object(p.a)({},a.lastMessageTimes),{},Object(h.a)({},e,Date.now()))},this.minsSinceLastChatMessage=function(e){return Math.floor((Date.now()-a.lastMessageTimes[e])/6e4)},this.getChatters=function(){return f("https://thingproxy.freeboard.io/fetch/https://tmi.twitch.tv/group/user/".concat(a.channel,"/chatters")).then((function(e){return e.json()})).then((function(e){return e&&e.chatters?[].concat(Object(m.a)(e.chatters.moderators),Object(m.a)(e.chatters.viewers),Object(m.a)(e.chatters.staff),Object(m.a)(e.chatters.admins),Object(m.a)(e.chatters.global_mods)):null})).catch((function(e){return null}))},this.channel=t,this.lastMessageTimes={},this.getStatusPromise=this.getStatusPromise.bind(this)}return Object(s.a)(e,[{key:"getStatusPromise",value:function(){var e=Object(c.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.channel){e.next=2;break}return e.abrupt("return",j);case 2:if(!(this.lastMessageTimes[t]&&this.minsSinceLastChatMessage(t)<10)){e.next=4;break}return e.abrupt("return",j);case 4:return e.abrupt("return",this.getChatters().then((function(e){return e&&e.includes(t)?v:O})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),k=a(130),x=a.n(k),w=a(6),S=a(40),P=a.n(S),M=a.p+"static/media/Commands.d88afb03.yaml",C=(a(221),a(283)),G=a(288),N=a(2),_=a(51),R=function(e,t){var a=e.entries;return Object(N.jsxs)(C.a,{striped:!0,bordered:!0,hover:!0,variant:"dark",responsive:"lg",className:"mb-0",children:[Object(N.jsx)("thead",{children:Object(N.jsxs)("tr",{className:"text-center align-middle",children:[Object(N.jsx)("th",{width:"10%",children:"Command"}),Object(N.jsx)("th",{width:"10%",children:"Permissions"}),Object(N.jsx)("th",{width:"40%",children:"Description"}),Object(N.jsx)("th",{width:"20%",children:"On Screen Equivalent"}),Object(N.jsx)("th",{width:"10%",children:"Variants"}),Object(N.jsx)("th",{width:"10%",children:"Example"})]})}),Object(N.jsx)("tbody",{className:"table-group-divider",children:!!a&&a.map(T)})]},"command-table-row-".concat(t))},T=function(e,t){var a=e.command,n=e.info,s=n.Example,r=n.Availability,o=n.Description,i=n.OnScreenEquivalent,c=n.Variants;return Object(N.jsxs)("tr",{className:"small",children:[Object(N.jsxs)("td",{className:"command-name fw-semibold fs-6 text-primary-emphasis",children:["!",a]}),Object(N.jsx)("td",{className:"text-center",children:r}),Object(N.jsx)("td",{children:o}),Object(N.jsx)("td",{children:i}),Object(N.jsx)("td",{className:"n/a"===c?null:"font-monospace fst-italic",children:c}),Object(N.jsx)("td",{className:"font-monospace fst-italic",children:s})]},"command-table-row-".concat(t))},q=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).onValidCommands=function(e){return s.setState((function(t){return Object(p.a)(Object(p.a)({},t),{},{validCommands:Object.entries(e).map((function(e,t){var a=Object(w.a)(e,2),n=a[0],s=a[1];return{section:n,commands:s,entries:Object.entries(s).map((function(e,t){var a=Object(w.a)(e,2);return{command:a[0],info:a[1]}}))}}))})}))},s.onSelectTab=function(e){return"All Commands"===e?s.setState({activeFilter:null}):s.setState({activeFilter:e})},s.state={activeFilter:null,validCommands:[]},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(e){var t=this;_(M).then((function(e){return e.text()})).then((function(e){var a=P.a.parse(e);return t.onValidCommands(a)}))}},{key:"render",value:function(){var e=this,t=this.state.validCommands,a=[{section:"All Commands"}].concat(Object(m.a)(t)).map((function(e){var t=e.section;return Object(N.jsx)(G.a.Item,{children:Object(N.jsx)(G.a.Link,{eventKey:t,"data-testid":t,children:t})},t)})),n=this.props.hideHeader?null:Object(N.jsx)("h1",{className:"fw-bolder pt-3",children:"Chat Commands"});return Object(N.jsxs)("div",{id:"commands-list",className:"container",children:[n,Object(N.jsx)(G.a,{variant:"tabs",activeKey:this.state.activeFilter||"All Commands",onSelect:this.onSelectTab,children:t.length>0&&a}),Object(N.jsx)("div",{className:"col-12 px-3 pb-1 mb-3 text-start commands-table-wrapper",children:!!t&&t.map((function(t,a){var n=e.state.activeFilter;return n&&n!==t.section?null:Object(N.jsxs)("div",{children:[Object(N.jsx)("h4",{className:"px-1 pt-3 fw-bolder",children:t.section},"section-table-row-".concat(a)),R(t)]},"section-".concat(a))})).filter((function(e){return e}))})]})}}]),a}(d.Component),L=a(284),I=a(286),A=a.p+"static/media/lock.6857c469.svg",D=(a(225),function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).deleteRequest=function(e){s.props.onDelete(s.props.gameName)},s.getFormattedTimeDiff=function(e){var t="minute",a=Math.floor((Date.now()-e)/6e4);return 0===a?"just now":(a>=60&&(t="hour",(a=Math.floor(a/60))>=24&&(t="day",a=Math.floor(a/24))),"".concat(a," ").concat(t).concat(1===a?"":"s"," ago"))},s.getTooltipContent=function(e){return Object(N.jsx)(L.a,Object(p.a)(Object(p.a)({id:"game-request-tooltip"},e),{},{children:Object(N.jsxs)("span",{className:"tooltipText",children:["Requested ",s.state.timeDiff," by ",s.props.metadata.username,Object(N.jsx)("span",{className:"status ".concat(s.getTooltipActivityStatusClassName())})]})}))},s.getTooltipActivityStatusClassName=function(){switch(s.state.activityStatus){case j:return"active";case v:return"idle";case O:return"disconnected";default:return""}},s.toggleLock=function(){return s.props.toggleLock(s.props.gameName)},s.updateStatus=Object(c.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.props.getActivity(s.props.metadata.username);case 3:return t=e.sent,e.abrupt("return",s.setState({timeDiff:s.getFormattedTimeDiff(s.props.metadata.time),activityStatus:t}));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),s.state={timeDiff:0,activityStatus:null},s.deleteRequest=s.deleteRequest.bind(Object(l.a)(s)),s.getFormattedTimeDiff=s.getFormattedTimeDiff.bind(Object(l.a)(s)),s.toggleLock=s.toggleLock.bind(Object(l.a)(s)),s.updateStatus=s.updateStatus.bind(Object(l.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.metadata.locked?"lock locked":"lock unlocked",t=this.props.metadata.chosen?"chosen":"pending";return Object(N.jsx)(I.a,{placement:"left",overlay:this.getTooltipContent,onEnter:this.updateStatus,children:Object(N.jsx)("div",{className:"game-request-wrapper fade-in",children:Object(N.jsx)("div",{id:"baseDiv",className:"game-request ".concat(t),children:Object(N.jsxs)("div",{className:"game-request-body",children:[Object(N.jsxs)("div",{className:"text-truncate",children:[Object(N.jsx)("b",{children:this.props.metadata.name})," ",Object(N.jsx)("small",{children:!!this.props.metadata.partyPack&&"(".concat(this.props.metadata.partyPack.replace("Party Pack","Pack"),")")})]}),Object(N.jsxs)("div",{className:"options",children:[Object(N.jsx)("img",{src:A,alt:"lock",className:e,onClick:this.toggleLock}),Object(N.jsx)("button",{type:"button",className:"deleteButton",onClick:this.deleteRequest,children:"X"})]})]})})})})}}]),a}(d.Component)),E=a(68),H=a(20),U=a.n(H),W=a.p+"static/media/JackboxGames.ea119c8e.yaml",F=a(65),V=a(51),B=a(229),Q="!request",z="!subrequest",J=[{RequestName:"Version",Response:"is using Twitch Request Wheel, v".concat(F.a),Variants:["version","v","info"]},{RequestName:"Affection",Response:function(){return"there there, it's going to be okay. VirtualHug"},Variants:["a friend","a hug","a kiss","friend","hug","kiss","affection","a shoulder to cry on","shoulder to cry on"]},{RequestName:"Goose",Response:"please don't taunt the wheel. Honk.",Variants:["goose","honk","meow","mrow","woof","bark","nugs","chicken nugs"]},{RequestName:"Lewmon",Response:"please don't taunt the wheel. sirfar3Lewmon sirfar3Lewmon sirfar3Lewmon",Variants:["lewmon","sirfar3lewmon"]},{RequestName:"DoTheDew",Response:"dewinbDTD dewinbDance dewinbGIR dewinbDance dewinbGIR dewinbDance dewinbDTD",Variants:["dothedew","dewinblack"]}],K=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).componentDidMount=function(e){var t=s.getTwitchClient(s.props);return s.client=t,t.on("message",s.onMessage),t.on("disconnected",s.onDisconnected),t.connect(),s.getGameList(W,t),s.getCommandList(M,t)},s.componentWillUnmount=function(e){try{s.client&&s.client.disconnect()}catch(t){console.log("Error",t)}},s.getCommandList=function(){var e=Object(c.a)(Object(i.a)().mark((function e(t,a){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t).then((function(e){return e.text()})).then((function(e){return s.setState({client:a,validCommands:P.a.parse(e)})})).catch((function(e){console.warn(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),s.getGameList=function(){var e=Object(c.a)(Object(i.a)().mark((function e(t,a){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t).then((function(e){return e.text()})).then((function(e){return s.setState({client:a,validGames:P.a.parse(e)})})).catch((function(e){console.warn(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),s.getTwitchClient=function(e){return new B.client({identity:{username:e.channel,password:e.access_token},channels:[e.channel],options:{skipUpdatingEmotesets:!0,updateEmotesetsTimer:0}})},s.isModOrBroadcaster=function(e){return s.props.channel===e||s.props.modList.includes(e.toLowerCase())},s.checkForMiscCommands=function(e,t){var a,n,r,o,i,c;if(e.startsWith("!commands")||e.startsWith("!wheelcommands")){var l;if(null!==(l=s.props.settings)&&void 0!==l&&l.useLinkForCommandList)s.sendMessage("/me @".concat(t,", list of all supported commands: ").concat("https://asukii314.github.io/twitch-request-wheel/#","/commands"));else{var d=Object.values(s.state.validCommands).flatMap((function(e){return Object.keys(e).map((function(e){return"!".concat(e)}))})).sort().join(" ");s.sendMessage("/me @".concat(t,", list of all supported commands: ").concat(d))}return!0}if(e.startsWith("!gamelist")||e.startsWith("!gameslist"))return s.sendMessage("/me @".concat(t,", list of available games: ").concat("https://asukii314.github.io/twitch-request-wheel/#","/gamelist")),!0;if(e.startsWith("!whichpack")){var u=e.replace("!whichpack","").trim();if(""===u)return s.sendMessage("/me @".concat(t,", please specify the game you would like to look up the party pack for: e.g. !whichpack TMP 2")),!0;var m=s.findGame(u,t);return m&&s.sendMessage("/me @".concat(t,", ").concat(m.name," is a ").concat(m.partyPack," game.")),!0}if("!onthewheel"===e||e.startsWith("!gamesqueue")||"!listrequests"===e){var h,p=null!==(h=s.props.settings)&&void 0!==h&&h.customDelimiter?" ".concat(s.props.settings.customDelimiter," "):" \u22c6 ",b=Object.values(s.props.messages).map((function(e){return e.name})).sort();try{s.sendMessage("/me @".concat(t,", Requested: ").concat(b.join(p),"."))}catch(q){s.sendMessage("/me @".concat(t,", Sorry, there are waaaaaaaaay too many games to list and something went wrong. :p")),console.log(q)}return!0}if(e.startsWith("!enablerequests"))return s.isModOrBroadcaster(t)?(null===(r=s.props)||void 0===r||r.toggleAllowGameRequests(!0),s.sendMessage("/me @".concat(t,', requests have now been enabled! Type "!request" followed by the game you want to play.')),!0):(s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0);if(e.startsWith("!disablerequests"))return s.isModOrBroadcaster(t)?(null===(o=s.props)||void 0===o||o.toggleAllowGameRequests(!1),s.sendMessage("/me @".concat(t,", requests have now been disabled.")),!0):(s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0);if(e.startsWith("!removegame")){var g;if(!s.isModOrBroadcaster(t))return s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0;var f=null===(g=s.props)||void 0===g?void 0:g.removeSelectedGameFromHistory();return!1===f?s.sendMessage("/me @".concat(t,", a game must be selected before you can remove it.")):s.sendMessage("/me @".concat(t,", the next game, ").concat(f.name,", has been removed.")),!0}if("!advancenextgame"===e||"!nextgamefwd"===e||"!nextgameforward"===e)return s.isModOrBroadcaster(t)?(s.props.changeNextGameIdx(1)?s.props.upcomingGames.length>0?s.sendMessage("/me @".concat(t,", the next game has been changed to ").concat(s.props.upcomingGames[0].name,".")):s.sendMessage("/me @".concat(t,', the next game has been marked as "TBD".')):s.sendMessage("/me @".concat(t,", there are no more games in the queue to advance to!")),!0):(s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0);if("!advanceprevgame"===e||"!nextgameback"===e||"!nextgamebackward"===e)return s.isModOrBroadcaster(t)?(s.props.changeNextGameIdx(-1)?s.sendMessage("/me @".concat(t,", the next game has been changed to ").concat(s.props.upcomingGames[0].name,".")):s.sendMessage("/me @".concat(t,", there are no previous games in the queue to go back to!")),!0):(s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0);if(e.startsWith("!setnextgame")||e.startsWith("!sng")||e.startsWith("!redeemgame")){if(!s.isModOrBroadcaster(t))return s.sendMessage("/me @".concat(t,", only channel moderators can use the ").concat(e.startsWith("!s")?"!setNextGame":"!redeemgame"," command.")),!0;var j=e.replace("!setnextgame","").replace("!sng","").replace("!redeemgame","").trim();if(""===j)return s.sendMessage("/me @".concat(t,", please specify the game you would like to insert in the queue: for example, ").concat(e.startsWith("!s")?"!setnextgame":"!redeemgame"," TMP 2")),!0;var v=s.findGame(j,t);if(v){var O,y,k=s.props.setNextGame(v);if(0===k?s.sendMessage("/me @".concat(t,", ").concat(v.name," has been inserted as the next game in the queue.")):s.sendMessage("/me @".concat(t,", ").concat(v.name," has been inserted in the queue following ").concat(k," other manual game request").concat(k>1?"s":"",".")),!0===(null===(O=s.props.settings)||void 0===O?void 0:O.clearSeatsAfterRedeem))null===(y=s.props)||void 0===y||y.clearQueueHandler()}return!0}if(e.startsWith("!addpack")||e.startsWith("!pack")){if(!s.isModOrBroadcaster(t))return s.sendMessage("/me @".concat(t,", only channel moderators can use the ").concat(e.startsWith("!a")?"!addpack":"!pack"," command.")),!0;var x=e.replace("!addpack","").replace("!pack","").trim();if(""===x)return s.sendMessage("/me @".concat(t,", please specify the pack you would like to insert in the queue: for example, ").concat(e.startsWith("!a")?"!addpack":"!pack"," 9")),!0;if("standalone"===x.toLowerCase())return s.sendMessage("/me @".concat(t,", sorry, you can only add Jackbox Party Pack games with this command.")),!0;var w=s.addPack(x,t);return w?s.sendMessage("/me @".concat(t,", ").concat(w.name," games have been added to the request queue.")):s.sendMessage("/me @".concat(t,", no games added; could not find any games for Party Pack ").concat(x,".")),!0}if("!caniplay"===e||e.startsWith("!new")||e.toLowerCase().startsWith("!dew")&&"dewinblack"===(null===(a=s.props)||void 0===a||null===(n=a.channel)||void 0===n?void 0:n.toLowerCase()))return null===(i=s.props)||void 0===i||i.caniplayHandler(t,{sendConfirmationMsg:"!caniplay"===e}),!0;if(e.startsWith("!priorityseat")||e.startsWith("!redeemseat")){var S;if(!s.isModOrBroadcaster(t))return s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0;var P=e.replace("!priorityseat","").replace("!redeemseat","").replace("@","").trim();return""===P?(s.sendMessage("/me @".concat(t,", please specify the user who has redeemed a priority seat in the next game: for example, ").concat(e.startsWith("!p")?"!priorityseat":"!redeemseat"," @asukii314")),!0):(null===(S=s.props)||void 0===S||S.caniplayHandler(P,{sendConfirmationMsg:!0,isPrioritySeat:!0}),!0)}if(e.startsWith("!removeuser")){var M;if(!s.isModOrBroadcaster(t))return s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0;var C=e.replace("!removeuser","").replace("@","").trim();return""===C?(s.sendMessage("/me @".concat(t,", please specify the user who will be removed in the next game: for example, !removeuser @dewinblack")),!0):(null===(M=s.props)||void 0===M||M.playerExitHandler(C),!0)}if("!leave"===e||"!murd"===e)return null===(c=s.props)||void 0===c||c.playerExitHandler(t),!0;if("!clear"===e){var G;if(s.isModOrBroadcaster(t))null===(G=s.props)||void 0===G||G.clearQueueHandler();return!0}if("!open"===e){var N;if(s.isModOrBroadcaster(t))null===(N=s.props)||void 0===N||N.openQueueHandler();return!0}if("!clearopen"===e){var _,R;if(s.isModOrBroadcaster(t))null===(_=s.props)||void 0===_||_.clearQueueHandler(),null===(R=s.props)||void 0===R||R.openQueueHandler();return!0}if("!close"===e){var T;if(s.isModOrBroadcaster(t))null===(T=s.props)||void 0===T||T.closeQueueHandler();return!0}if("!startgame"===e)return s.isModOrBroadcaster(t)?(s.props.startGame()?s.sendMessage("/me @".concat(t,", the game has been started.")):s.sendMessage("/me @".concat(t,", the game was already started.")),!0):(s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0);if("!undostart"===e){if(!s.isModOrBroadcaster(t))return s.sendMessage("/me @".concat(t,", only channel moderators can use this command.")),!0;try{s.props.undoStart(),s.sendMessage("/me @".concat(t,", previous game and player queues have been restored."))}catch(q){s.sendMessage("/me @".concat(t,", cannot restore previous game and/or player queues."))}return!0}return e.startsWith("!redeem")?(s.sendMessage("/me @".concat(t,", this command is no longer supported: please specify either !redeemgame or !redeemseat.")),!0):void 0},s.findGame=function(e,t){var a,n=/[\s:']+/g,r=Object(E.a)(J);try{for(r.s();!(a=r.n()).done;){var o,i,c=a.value;if(null!==c&&void 0!==c&&null!==(o=c.Variants)&&void 0!==o&&o.includes(e)||null!==c&&void 0!==c&&null!==(i=c.Variants)&&void 0!==i&&i.includes(e.replace(n,"")))return"function"===typeof c.Response?s.sendMessage("/me @".concat(t," ").concat(c.Response())):s.sendMessage("/me @".concat(t," ").concat(c.Response)),null}}catch(f){r.e(f)}finally{r.f()}for(var l in s.state.validGames)for(var d=s.state.validGames[l],u=0,m=Object.entries(d);u<m.length;u++){var h=Object(w.a)(m[u],2),b=h[0],g=h[1];if(null!==g&&void 0!==g&&g.Variants&&0!==(null===g||void 0===g?void 0:g.Variants.length))if(g.Variants.map((function(e){return e.replace(n,"")})).includes(e.replace(n,"")))return Object(p.a)({name:b,longName:"".concat(b," (").concat(l,")"),partyPack:l},g)}s.sendMessage("/me @".concat(t,", ").concat(e," could not be found in the list of available games: ").concat("https://asukii314.github.io/twitch-request-wheel/#","/gamelist"))},s.checkForGameCommand=function(e,t){if(e.startsWith(Q)){var a=e.replace(Q,"").trim();return""===a?(s.sendMessage("/me @".concat(t,", please specify the game you would like to request: for example, !request TMP 2")),null):s.findGame(a,t)}},s.checkForSubrequest=function(e,t,a){if(e.startsWith(z)){if(!0!==a&&s.props.channel!==t&&"dannyzonegames"!==t.toLowerCase())return s.sendMessage("/me @".concat(t,", you must be a subscriber to use this command.")),null;var n=e.replace(z,"").trim();return""===n?(s.sendMessage("/me @".concat(t,", please specify the game you would like to request: for example, !request TMP 2")),null):s.findGame(n,t)}},s.onConnected=function(e){s.setState({client:e,connected:!0})},s.onDisconnected=function(e){s.setState({client:null,connected:!1})},s.onMessage=function(e,t,a,n){var r,o;if(s.props.logUserMessages&&console.log({target:e,tags:t,msg:a,self:n}),!n)if(s.props.onMessage(a,t.username,t),"!nextgame"!==a.trim())if("!lastgame"!==a.trim()){var i=a.trim().toLowerCase();if(!s.checkForMiscCommands(i,t.username)){var c=s.checkForGameCommand(i,t.username),l=!1;if(!c&&null!==(r=s.props.settings)&&void 0!==r&&r.enableSubRequests&&(l=!0,c=s.checkForSubrequest(i,t.username,t.subscriber)),c)if(s.props.messages[c.longName]){var d=s.props.messages[c.longName].username===t.username?"yourself, silly":s.props.messages[c.longName].username;s.sendMessage("/me @".concat(t.username,", ").concat(c.name," has already been requested by ").concat(d,"!"))}else if(!0===s.props.allowGameRequests){for(var u=null,h=null,p=0,b=Object.values(s.props.messages);p<b.length;p++){var g=b[p];if(g.username===t.username&&g.isSubRequest===l){l?h=g.longName:u=g.longName;break}}var f=null===(o=s.props.settings)||void 0===o?void 0:o.enableSubRequestLimit;if(u||h)s.props.channel===t.username?s.sendMessage("/me @".concat(t.username,", ").concat(c.name," has been added to the request queue. Your previous game request(s) weren't deleted, since you have special broadcaster privilege :P")):l&&(!f||f&&!h)?s.sendMessage("/me @".concat(t.username,", ").concat(c.name," has been added to the request queue via a subrequest.")):h?(s.props.onDelete(h),s.sendMessage("/me @".concat(t.username,", your previous request of ").concat(h," has been replaced with ").concat(c.name,"."))):(s.props.onDelete(u),s.sendMessage("/me @".concat(t.username,", your previous request of ").concat(u," has been replaced with ").concat(c.name,".")));else{if(1===Object.values(s.state.allowedGames).filter((function(e){return e.game===c.name&&e.pack===c.partyPack&&!0!==e.enabled})).length)return void s.sendMessage("/me @".concat(t.username,", ").concat(c.name," is not currently enabled and was not added to the queue."));s.sendMessage("/me @".concat(t.username,", ").concat(c.name," has been added to the request queue."))}s.props.addGameRequest(c,t.username,l)}else s.sendMessage("/me @".concat(t.username,", game requests are currently paused at the moment, please try again later."))}}else if(s.props.previousGames&&s.props.previousGames.length>0){var j=Object(m.a)(s.props.previousGames).reverse(),v=j[0].name;if(j.length>1){v+=", followed by ".concat(j[1].name);for(var O=2;O<j.length;O++)v+=O+1===j.length?", and ".concat(j[O].name):", ".concat(j[O].name)}s.sendMessage("/me @".concat(t.username,", the last game played was ").concat(v,"!"))}else s.sendMessage("/me @".concat(t.username,", no games have been played yet - feel free to !request one :)"));else if(s.props.upcomingGames&&s.props.upcomingGames.length>0){var y=s.props.upcomingGames[0].name;if(s.props.upcomingGames.length>1){y+=", followed by ".concat(s.props.upcomingGames[1].name);for(var k=2;k<s.props.upcomingGames.length;k++)y+=", and ".concat(s.props.upcomingGames[k].name)}s.sendMessage("/me @".concat(t.username,", the next game up is ").concat(y,"!"))}else s.sendMessage("/me @".concat(t.username,", the next game hasn't been decided yet - feel free to !request one :)"))},s.addPack=function(e,t){for(var a in s.state.validGames){var n=a.trim().toLowerCase().replace(/([^\d]+)/gi,"");if(window.console.log({packslug:n,pack:e}),n===e){for(var r=s.state.validGames[a],o=0,i=Object.entries(r);o<i.length;o++){var c=Object(w.a)(i[o],2),l=c[0],d=c[1];s.props.addGameRequest(Object(p.a)({name:l,longName:"".concat(l," (").concat(a,")"),partyPack:a},d),t,!1)}return{name:a}}}},s.sendMessage=function(e){return s.state.client.say(s.props.channel,e)},s.setAllowedGames=function(e){s.setState({allowedGames:e})},s._disconnect=Object(c.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!s.client){e.next=6;break}return e.next=4,s.client.disconnect();case 4:s.client.removeAllListeners(),s.onDisconnected();case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),console.log("Error Disconnecting Twitch Client",e.t0),e.abrupt("return",!1);case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,null,[[0,8]])}))),s._connect=Object(c.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=s.getTwitchClient(s.props),s.client=t,t.on("message",s.onMessage),t.on("disconnected",s.onDisconnected),e.next=7,t.connect();case 7:return s.onConnected(t),e.abrupt("return",t);case 11:e.prev=11,e.t0=e.catch(0),console.log("Error Reconnecting Twitch Client",e.t0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])}))),s.refreshTwitchClient=Object(c.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s._disconnect();case 2:return e.next=4,s._connect();case 4:return e.abrupt("return");case 5:case"end":return e.stop()}}),e)}))),s.reloadGameList=function(){var e="".concat(W,"?").concat(Date.now());return s.getGameList(e,s.client)},s.state={client:null,connected:!1,allowedGames:{},validCommands:{},validGames:[]},s.getTwitchClient=s.getTwitchClient.bind(Object(l.a)(s)),s.isModOrBroadcaster=s.isModOrBroadcaster.bind(Object(l.a)(s)),s.checkForMiscCommands=s.checkForMiscCommands.bind(Object(l.a)(s)),s.findGame=s.findGame.bind(Object(l.a)(s)),s.checkForGameCommand=s.checkForGameCommand.bind(Object(l.a)(s)),s.onMessage=s.onMessage.bind(Object(l.a)(s)),s.onDisconnected=s.onDisconnected.bind(Object(l.a)(s)),s.sendMessage=s.sendMessage.bind(Object(l.a)(s)),s.refreshTwitchClient=s.refreshTwitchClient.bind(Object(l.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){return null}}],[{key:"propTypes",get:function(){return{logUserMessages:U.a.bool,toggleAllowGameRequests:U.a.func}}},{key:"defaultProps",get:function(){return{logUserMessages:!1,toggleAllowGameRequests:function(){}}}}]),a}(d.Component),Y=a(285),X=a(289),Z=a(134),$=a(287),ee=(a(249),a(51)),te=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).getAllowedGames=function(e){var t,a=localStorage.getItem("__allowedGames"),n=a?JSON.parse(a):{};return Object.assign.apply(Object,[{}].concat(Object(m.a)((t=[]).concat.apply(t,Object(m.a)(Object.entries(e).map((function(e){var t=Object(w.a)(e,2),a=t[0],s=t[1];return Object.assign.apply(Object,[{}].concat(Object(m.a)(Object.keys(s).map((function(e){var t="".concat(a," ").concat(e).replace(/\W/gi,"_");return t in n&&void 0!==n[t].id?Object(h.a)({},t,n[t]):Object(h.a)({},t,{id:t,game:e,pack:a,enabled:!0})})))))})))))))},s.setAllowedGames=function(e){var t=this.getAllowedGames(e);this.setState({allowedGames:t,validGames:e}),localStorage.setItem("__allowedGames",JSON.stringify(t))},s.onCheckHandler=function(e){var t=e.target,a=t.id,n=t.checked;s.setState((function(e){return{allowedGames:Object(p.a)(Object(p.a)({},e.allowedGames),{},Object(h.a)({},a,Object(p.a)(Object(p.a)({},e.allowedGames[a]),{},{enabled:n})))}}))},s.onGroupCheckHandler=function(e){var t=e.target,a=t.value,n=t.checked,r=Object.values(s.state.allowedGames).filter((function(e){return e.pack===a}));s.setState((function(e){return{allowedGames:Object(p.a)(Object(p.a)({},e.allowedGames),Object.assign.apply(Object,Object(m.a)(r.map((function(e){return Object(h.a)({},e.id,Object(p.a)(Object(p.a)({},e),{},{enabled:n}))})))))}}))},s.renderGameCard=function(e){var t,a=e.id,n=e.game,s=e.pack,r=(null===(t=this.state.allowedGames[a])||void 0===t?void 0:t.enabled)||!1;return Object(N.jsxs)("li",{className:"gameName",children:[Object(N.jsx)("input",{type:"checkbox",id:a,name:a,value:a,checked:r,onChange:this.onCheckHandler})," ",Object(N.jsx)("label",{htmlFor:a,title:"".concat(s,": ").concat(n),children:n})]},a)},s.renderPackCheckbox=function(e){var t=Object.values(this.state.allowedGames).filter((function(t){return t.pack===e})),a=t.filter((function(e){return!0===e.enabled})).length===t.length;return Object(N.jsx)("input",{type:"checkbox",id:e,name:e,value:e,checked:a,onChange:this.onGroupCheckHandler})},s.renderPartyPack=function(e){var t=this,a=Object.keys(e.metadata),n=Object.values(this.state.allowedGames).filter((function(t){return t.pack===e.partyPackName})),s=n.filter((function(e){return!0===e.enabled})),r=s.length===n.length,o=!r&&0!==s.length;return Object(N.jsxs)($.a.Item,{eventKey:e.key,className:"party-pack-card",children:[Object(N.jsx)($.a.Header,{className:"bg-darker text-white",children:e.partyPackName}),Object(N.jsxs)($.a.Body,{children:[Object(N.jsxs)("div",{className:"float-end",children:[Object(N.jsx)("small",{children:"Select All"})," ",Object(N.jsx)("input",{type:"checkbox",id:e.partyPackName,name:e.partyPackName,value:e.partyPackName,checked:r,onChange:this.onGroupCheckHandler,ref:function(e){return e&&(e.indeterminate=o)}})]}),Object(N.jsx)("ul",{className:"party-pack-game-list",children:a.map((function(a,n){return t.renderGameCard({game:a,id:"".concat(e.partyPackName," ").concat(a).replace(/\W/gi,"_"),pack:e.partyPackName})}))})]})]},e.key)},s.state={allowedGames:[],validGames:[]},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(e){var t=this;ee(W).then((function(e){return e.text()})).then((function(e){var a=P.a.parse(e);t.setAllowedGames(a)}))}},{key:"componentDidUpdate",value:function(){this.state.allowedGames&&0!==this.state.validGames.length&&0!==this.state.allowedGames.length&&localStorage.setItem("__allowedGames",JSON.stringify(this.state.allowedGames))}},{key:"render",value:function(){var e=this,t=this.state.validGames,a=Object.keys(t);return Object(N.jsx)($.a,{id:"options-game-list",className:"accordion-dark",flush:!0,children:a.map((function(t,a){return e.renderPartyPack({key:a,partyPackName:t,metadata:e.state.validGames[t]})}))})}}]),a}(d.Component),ae=(a(250),function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).createDebugMenuItems=function(e){return e?e.map((function(e,t){return e&&e.label?/^[-]+$/i.test(e.label)?Object(N.jsx)(Y.a.Divider,{},"".concat(t," ").concat(e.label)):Object(N.jsx)(Y.a.Item,{eventKey:e.label,href:e.href||null,onClick:e.onClick||null,children:e.label},"".concat(t," ").concat(e.label)):null})).filter((function(e){return e})):[]},s.createMenuItems=function(e){if(!e)return[];var t=function(){};return e.map((function(e,a){if(!e.label)return null;var n=["mb-1 fs-4 d-grid text-start",(e.listItemClassName?e.listItemClassName:e.label.trim().toLowerCase().split(" ").join("-"))||null].filter((function(e){return e})).join(" "),s=["btn",e.btnClassName||null].filter((function(e){return e})).join(" ");return Object(N.jsx)("li",{className:n,children:Object(N.jsx)(g.a,{variant:"link",className:s,onClick:e.onClick||t,children:e.label})},"".concat(a,"-").concat(e.label))})).filter((function(e){return e}))},s.toggleGameList=function(){s.setState((function(e){return{showGameList:!e.showGameList}}))},s.toggleSettingsMenu=function(){s.setState((function(e){return{showSettingsMenu:!e.showSettingsMenu}}))},s.state={showGameList:!1},s.toggleGameList=s.toggleGameList.bind(Object(l.a)(s)),s.toggleSettingsMenu=s.toggleSettingsMenu.bind(Object(l.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){var e,t,a,n=this.props,s=n.debugItems,r=n.items,o=n.settings,i=n.onSettingsUpdate,c=this.createMenuItems(r),l=this.createDebugMenuItems(s),d=this.props.showUndoAvailable?Object(N.jsx)("li",{className:"mb-1 fs-4 d-grid text-start",children:Object(N.jsxs)(g.a,{variant:"link",className:"btn undo-start-game",onClick:this.props.onUndo,children:["Undo Start",Object(N.jsxs)("div",{className:"fs-6 fst-italic opacity-75 lh-1",children:["Start Time: ",null===(e=this.props.parentState)||void 0===e?void 0:e.lastStartTimestamp]})]})}):null;return Object(N.jsxs)(X.a,{id:"options-menu",onHide:this.props.onHide,placement:"end",show:this.props.showOptionsMenu,children:[Object(N.jsx)(X.a.Header,{closeButton:!0,closeVariant:"white",children:Object(N.jsx)(X.a.Title,{as:"h2",className:"fw-bold",children:"Options"})}),Object(N.jsxs)(X.a.Body,{children:[Object(N.jsxs)("ul",{className:"options-menu-items list-unstyled pb-3 px-4",children:[Object(N.jsx)("li",{className:"mb-1 fs-4 d-grid text-start",children:Object(N.jsx)(g.a,{variant:"link",className:"btn logout",onClick:this.props.onLogout,children:"Logout"})}),Object(N.jsx)("hr",{}),d,Object(N.jsx)("li",{className:"mb-1 fs-4 d-grid text-start",children:Object(N.jsx)(g.a,{variant:"link",className:"btn logout",onClick:this.props.toggleCommandsModal,children:"Show Chat Commands"})}),Object(N.jsx)("li",{className:"mb-1 fs-4 d-grid text-start",children:Object(N.jsx)(g.a,{variant:"link",className:"btn settings-menu",onClick:this.toggleSettingsMenu,children:"Settings"})}),Object(N.jsx)(Z.a,{in:this.state.showSettingsMenu,children:Object(N.jsx)("div",{id:"settings-menu",className:"accordion-dark accordion accordion-flush",children:Object(N.jsxs)("div",{className:"accordion-body",children:[Object(N.jsxs)(g.a,{variant:"link",className:"btn settings-menu",onClick:function(){var e="boolean"!==typeof(null===o||void 0===o?void 0:o.enableSubRequests)||!(null!==o&&void 0!==o&&o.enableSubRequests);i({enableSubRequests:e})},title:"Allows subscribers to make additional game requests when enabled.",children:[Object(N.jsx)("input",{type:"checkbox",role:"switch",checked:null===o||void 0===o?void 0:o.enableSubRequests,readOnly:!0})," ",Object(N.jsx)("span",{children:"Enable Sub Requests"})]}),Object(N.jsxs)(g.a,{variant:"link",className:"btn settings-menu subsetting",onClick:function(){var e="boolean"!==typeof(null===o||void 0===o?void 0:o.enableSubRequestLimit)||!(null!==o&&void 0!==o&&o.enableSubRequestLimit);i({enableSubRequestLimit:e})},title:"Limit subscribers to one additional game requests when enabled.",disabled:!(null!==o&&void 0!==o&&o.enableSubRequests),children:[Object(N.jsx)("input",{type:"checkbox",role:"switch",checked:null===o||void 0===o?void 0:o.enableSubRequestLimit,readOnly:!0})," ",Object(N.jsx)("span",{children:"Limit 1 Sub Request"})]}),Object(N.jsxs)(g.a,{variant:"link",className:"btn settings-menu",onClick:function(){var e="boolean"!==typeof(null===o||void 0===o?void 0:o.clearSeatsAfterRedeem)||!(null!==o&&void 0!==o&&o.clearSeatsAfterRedeem);i({clearSeatsAfterRedeem:e})},title:"Clears the list of player signups after a game redemption.",children:[Object(N.jsx)("input",{type:"checkbox",role:"switch",checked:null===o||void 0===o?void 0:o.clearSeatsAfterRedeem,readOnly:!0})," ",Object(N.jsx)("span",{children:"Clear Seats After Redeem"})]}),Object(N.jsxs)(g.a,{variant:"link",className:"btn settings-menu",title:"Uses a custom character or emote to separate requests listed in the chat.",children:[Object(N.jsx)("span",{children:"Use Custom Delimiter: "}),Object(N.jsx)("input",{type:"text",name:"custom-delimiter",defaultValue:null===o||void 0===o?void 0:o.customDelimiter,onChange:function(e){var t=e.target.value;t=t?t.trim():null,i({customDelimiter:t})},className:"form-control"})]}),Object(N.jsxs)(g.a,{variant:"link",className:"btn settings-menu",onClick:function(){var e="boolean"!==typeof(null===o||void 0===o?void 0:o.enableRoomCode)||!(null!==o&&void 0!==o&&o.enableRoomCode);i({enableRoomCode:e})},title:"Allows host to set a room code that can be whispered to players.",children:[Object(N.jsx)("input",{type:"checkbox",role:"switch",checked:null===o||void 0===o?void 0:o.enableRoomCode,readOnly:!0})," ",Object(N.jsx)("span",{children:"Enable Room Code"})]}),Object(N.jsxs)(g.a,{variant:"link",className:"btn settings-menu",onClick:function(){var e="boolean"!==typeof(null===o||void 0===o?void 0:o.useLinkForCommandList)||!(null!==o&&void 0!==o&&o.useLinkForCommandList);i({useLinkForCommandList:e})},title:"Posts a link in chat to the commands page when '!command' is used; otherwise, lists all available commands in chat when disabled.",children:[Object(N.jsx)("input",{type:"checkbox",role:"switch",checked:null===o||void 0===o?void 0:o.useLinkForCommandList,readOnly:!0})," ",Object(N.jsxs)("span",{children:["Use Link for ",Object(N.jsx)("tt",{children:"!command"})]})]})]})})}),c,Object(N.jsx)("li",{className:"mb-1 fs-4 d-grid text-start d-none",children:Object(N.jsx)(g.a,{variant:"link",className:"btn reload-game-list",onClick:this.props.reloadGameList,children:"Refresh Game List"})}),Object(N.jsx)("li",{className:"mb-1 fs-4 d-grid text-start d-none",children:Object(N.jsx)(g.a,{variant:"link",className:"btn game-list",onClick:this.toggleGameList,children:"Game List"})}),Object(N.jsx)(Z.a,{in:this.state.showGameList,children:Object(N.jsx)("div",{children:Object(N.jsx)(te,{allowedGames:null===(t=this.props.gamesList)||void 0===t?void 0:t.allowedGames,validGames:null===(a=this.props.gamesList)||void 0===a?void 0:a.validGames})})})]}),Object(N.jsx)("div",{id:"options-debug-menu-items",className:"position-absolute bottom-0 start-0 end-0 pb-3 text-center",children:Object(N.jsxs)(Y.a,{id:"dropdown-debug-menu-items",drop:"up-centered",variant:"link",children:[Object(N.jsx)(Y.a.Toggle,{id:"dropdown-debug-menu-items-toggle",size:"sm",variant:"link",children:"version ".concat(F.a)}),Object(N.jsxs)(Y.a.Menu,{variant:"dark",children:[Object(N.jsx)(Y.a.Header,{children:"Debug Options"}),l]})]})})]})]})}}],[{key:"propTypes",get:function(){return{debugItems:U.a.array,gamesList:U.a.object,items:U.a.array,onHide:U.a.func,onLogout:U.a.func,onUndo:U.a.func,showOptionsMenu:U.a.bool,showSettingsMenu:U.a.bool,showUndoAvailable:U.a.bool}}},{key:"defaultProps",get:function(){return{debugItems:[],gamesList:{allowedGames:null,validGames:null},items:[],onHide:function(){},onLogout:function(){},onUndo:function(){},showOptionsMenu:!1,showSettingsMenu:!1,showUndoAvailable:!1}}}]),a}(d.Component)),ne={gameSelected:null,messages:{"Survive The Internet (Party Pack 4)":{name:"Survive The Internet",longName:"Survive The Internet (Party Pack 4)",partyPack:"Party Pack 4","Min players":3,"Max players":8,Variants:["survive","survive the internet","sti"],username:"dcpesses",time:1628112883959,locked:!1,chosen:!1},"Quiplash (Any Version)":{name:"Quiplash",longName:"Quiplash (Any Version)",partyPack:"Any Version","Min players":3,"Max players":8,Variants:["quiplash","quip","ql"],username:"dcpesses",time:1628113055677,locked:!1,chosen:!1},"You Don't Know Jack (Party Pack 5)":{name:"You Don't Know Jack",longName:"You Don't Know Jack (Party Pack 5)",partyPack:"Party Pack 5","Min players":1,"Max players":8,Variants:["ydkj 2","ydkj fs","ydkjfs","you dont know jack 2","you don't know jack 2","you don't know jack full stream","you don't know jack full steam","you don't know jack: full stream"],username:"dcpesses",time:1628114634007,locked:!1,chosen:!1},"Mad Verse City (Party Pack 5)":{name:"Mad Verse City",longName:"Mad Verse City (Party Pack 5)",partyPack:"Party Pack 5","Min players":3,"Max players":8,Variants:["mvc","madverse","mad verse","madversecity","mad verse city"],username:"dcpesses",time:1628114645263,locked:!1,chosen:!1},"Monster Seeking Monster (Party Pack 4)":{name:"Monster Seeking Monster",longName:"Monster Seeking Monster (Party Pack 4)",partyPack:"Party Pack 4","Min players":3,"Max players":7,Variants:["msm","monster seeking monster","monster seeking monsters","monsters seeking monsters"],username:"dcpesses",time:1628114646991,locked:!1,chosen:!1},"Blather 'Round (Party Pack 7)":{name:"Blather 'Round",longName:"Blather 'Round (Party Pack 7)",partyPack:"Party Pack 7","Min players":2,"Max players":6,Variants:["blather","blather round","blather 'round","blatherround","blatheround"],username:"dcpesses",time:1628114733155,locked:!1,chosen:!1},"Talking Points (Party Pack 7)":{name:"Talking Points",longName:"Talking Points (Party Pack 7)",partyPack:"Party Pack 7","Min players":3,"Max players":8,Variants:["talking points","talkingpoints","talk points"],username:"dcpesses",time:1628114749438,locked:!1,chosen:!1},"Gartic Phone (Standalone)":{name:"Gartic Phone",longName:"Gartic Phone (Standalone)",partyPack:"Standalone","Min players":4,"Max players":30,Variants:["gartic phone","garticphone","garlic phone","garlicphone","gartic","garlic"],username:"dcpesses",time:1628114761558,locked:!1,chosen:!1},"Drawful (Any Version)":{name:"Drawful",longName:"Drawful (Any Version)",partyPack:"Any Version","Min players":3,"Max players":8,Variants:["drawful","drawfull","draw full"],username:"dcpesses",time:1628114769626,locked:!1,chosen:!1},"Words on Stream (Standalone)":{name:"Words on Stream",longName:"Words on Stream (Standalone)",partyPack:"Standalone","Min Players":4,"Max Players":50,Variants:["words on stream","word on stream","words stream","word stream","words","wos"],username:"dcpesses",time:1628114772430,locked:!1,chosen:!1},"Gartic on Stream (Standalone)":{name:"Gartic on Stream",longName:"Gartic on Stream (Standalone)",partyPack:"Standalone","Min Players":4,"Max Players":50,Variants:["gartic on stream","garlic on stream","garlic stream","gartic stream","gos"],username:"dcpesses",time:1628114776310,locked:!1,chosen:!1},"The Devils and the Details (Party Pack 7)":{name:"The Devils and the Details",longName:"The Devils and the Details (Party Pack 7)",partyPack:"Party Pack 7","Min players":3,"Max players":8,Variants:["devils","devils in details","devils and details","devils & details","devil's in details","devil's and details","devil's & details","devils in the details","devils and the details","devils & the details","devil's in the details","devil's and the details","devil's & the details","the devils in the details","the devils and the details","the devils & the details","the devil's in the details","the devil's and the details","the devil's & the details"],username:"dcpesses",time:1628114937776,locked:!1,chosen:!1},"Fibbage: Enough About You (Party Pack 4)":{name:"Fibbage: Enough About You",longName:"Fibbage: Enough About You (Party Pack 4)",partyPack:"Party Pack 4","Min players":2,"Max players":8,Variants:["eay","enough about you","feay","fibbage eay","fibbage: eay","fibbage enough about you","fibbage: enough about you"],username:"dcpesses",time:1628114942915,locked:!1,chosen:!1},"Champ'd Up (Party Pack 7)":{name:"Champ'd Up",longName:"Champ'd Up (Party Pack 7)",partyPack:"Party Pack 7","Min players":3,"Max players":8,Variants:["champd","champed","champd up","champ'd","champ'd up","champed up"],username:"dcpesses",time:1628114981572,locked:!1,chosen:!1},"Civic Doodle (Party Pack 4)":{name:"Civic Doodle",longName:"Civic Doodle (Party Pack 4)",partyPack:"Party Pack 4","Min players":3,"Max players":8,Variants:["civic doodle","civicdoodle","civic"],username:"dcpesses",time:1628115017116,locked:!1,chosen:!1},"Trivia Murder Party 2 (Party Pack 6)":{name:"Trivia Murder Party 2",longName:"Trivia Murder Party 2 (Party Pack 6)",partyPack:"Party Pack 6","Min players":1,"Max players":8,Variants:["tmp2","tmp 2","trivia murder party 2"],username:"dcpesses",time:1628118545790,locked:!1,chosen:!1},"Quiplash 3 (Party Pack 7)":{name:"Quiplash 3",longName:"Quiplash 3 (Party Pack 7)",partyPack:"Party Pack 7","Min players":3,"Max players":8,Variants:["ql3","ql 3","quip 3","quip3","quiplash 3","quiplash3"],username:"dcpesses",time:1628121075780,locked:!1,chosen:!1},"Trivia Murder Party 1 (Party Pack 3)":{name:"Trivia Murder Party 1",longName:"Trivia Murder Party 1 (Party Pack 3)",partyPack:"Party Pack 3","Min players":1,"Max players":8,Variants:["tmp1","tmp 1","trivia murder party 1"],username:"dcpesses",time:1628122719930,locked:!1,chosen:!1}},colors:["#75a5e5","#847cef","#74aee0","#86efed","#63bbd8","#c9d8ff","#97ecef","#bcefff","#9caff4","#b9a4f2","#9fbbfc","#affffc","#a1bef4","#7ee7fc","#97c1ef","#a4a4fc","#a4a5f4","#b7f1ff","#79bdfc","#6885dd","#98e1f2","#aac1ff","#a583fc","#8991e5","#6edddd","#a7b7ef","#74e2e8","#9c9af9","#9dd5f2","#6a73ed","#b19df9","#88eaea","#6b91ef","#9de1f9","#7691fc","#d0c4fc","#c9d7ff","#84a7ed","#809bfc","#63d0d8","#b8cbfc","#a3a0ff","#b4f4f7","#9c9efc","#8ae8f7","#7985ea","#7876e8","#cfc2fc","#bfcfff","#92a9f4","#d0c2fc","#adc9f7","#767ce0","#95a1f9","#a286f4","#8085ed","#c4c9fc","#7c8ff9","#7079f9","#aaa5ff","#8db7e8","#9e94e8","#a5ffff","#76ade8","#a9f5fc","#a0a5ff","#9cbffc","#8fa2e8","#8eeeff","#88ccf7","#b0f2f4","#8e7fef","#aef9f8","#8beef9","#7a8ef4","#c7c4fc","#7b87f2","#7b77ea","#859be5","#7191e8","#aadaef","#b1aaf7","#80bff7","#95e0f4","#a3e5ed","#91a1f2","#c0c4f9","#7a90f4","#85def2","#87f2ee","#cac6ff","#76c3f7","#c2dcfc","#a2a2f9","#ccd7ff","#978fef","#8d77e5","#bad0fc","#ccf7ff"],counter:26,history:[{name:"Zeeple Dome",longName:"Zeeple Dome (Party Pack 5)",partyPack:"Party Pack 5","Min players":1,"Max players":6,Variants:["zeeple","zeeple dome","zeepledome"],username:"dcpesses",time:1628114757634,locked:!1,chosen:!1,override:!1},{name:"Split the Room",longName:"Split the Room (Party Pack 5)",partyPack:"Party Pack 5","Min players":3,"Max players":8,Variants:["split the room","splittheroom","split room","room split","split","str"],username:"dcpesses",time:1628114989864,locked:!1,chosen:!1,override:!1},{name:"Fibbage 3",longName:"Fibbage 3 (Party Pack 4)",partyPack:"Party Pack 4","Min players":2,"Max players":8,Variants:["fibbage 3","fibbage3"],username:"dcpesses",time:1628114666823,locked:!1,chosen:!1,override:!1},{name:"Trivia Murder Party",longName:"Trivia Murder Party (Any Version)",partyPack:"Any Version","Min players":1,"Max players":8,Variants:["tmp","trivia murder party"],username:"dcpesses",time:1628106145996,locked:!1,chosen:!1,override:!1}],nextGameIdx:0,showPlayerSelect:!1,userLookup:{dcpesses:{color:"#1E90FF","user-id":"473294395",username:"dcpesses"}}},se={interested:[{username:"player6",isPrioritySeat:!1},{username:"player3",isPrioritySeat:!1},{username:"player9"},{username:"dcpesses"}],playing:[{username:"player1",isPrioritySeat:!0},{username:"player7",isPrioritySeat:!1},{username:"player8"},{username:"player5",isPrioritySeat:!0},{username:"player2",isPrioritySeat:!0}],joined:[],streamerSeat:!0,isQueueOpen:!0,columnWidth:634},re=a.p+"static/media/dice.021a7158.svg",oe=a.p+"static/media/star.de82f684.svg",ie=(a(251),function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).updateColumnSizes=function(){s.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{columnWidth:s.firstColumn.current.offsetWidth})}))},s.handleNewPlayerRequest=function(e,t){var a,n,r,o,i,c,l,d,u,m=t.isPrioritySeat,h=void 0!==m&&m;if(h){var p=s.state.isQueueOpen?"playing":"interested";return s.updateColumnForUser({username:e,isPrioritySeat:h},p)?"you have been successfully added to the lobby.":"there was an error adding you to the lobby."}return null!==(a=s.state)&&void 0!==a&&null!==(n=a.interested)&&void 0!==n&&null!==(r=n.map((function(e){return e.username})))&&void 0!==r&&r.includes(e)||null!==(o=s.state)&&void 0!==o&&null!==(i=o.playing)&&void 0!==i&&null!==(c=i.map((function(e){return e.username})))&&void 0!==c&&c.includes(e)||null!==(l=s.state)&&void 0!==l&&null!==(d=l.joined)&&void 0!==d&&null!==(u=d.map((function(e){return e.username})))&&void 0!==u&&u.includes(e)?"you are already in the lobby.":s.state.isQueueOpen?s.updateColumnForUser({username:e},"interested")?"you have successfully joined the lobby.":"there was an error adding you to the lobby.":"the queue is currently closed; users have already been selected for this game."},s.handleRoomCodeChange=function(e){var t,a;null!==(t=e.target)&&void 0!==t&&t.value&&(a=e.target.value.trim()),s.setState({roomCode:a})},s.handleRoomCodeFocus=function(e){return e.target.select()},s.updateColumnForUser=function(e,t){return!(!s.state||!s.state[t])&&(s.removeUser(e.username),s.setState((function(a){return Object(p.a)(Object(p.a)({},a),{},Object(h.a)({},t,[].concat(Object(m.a)(a[t]),[e])))})),!0)},s.removeUser=function(e){return s.setState((function(t){return Object(p.a)(Object(p.a)({},t),{},{interested:t.interested.filter((function(t){return t.username!==e})),playing:t.playing.filter((function(t){return t.username!==e})),joined:t.joined.filter((function(t){return t.username!==e}))})}))},s.clearQueue=function(){return s.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{interested:[],playing:[],joined:[]})}))},s.openQueue=function(){return s.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{isQueueOpen:!0})}))},s.closeQueue=function(){return s.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{isQueueOpen:!1})}))},s.playerCount=function(){return s.state.playing.length+s.state.joined.length+(s.state.streamerSeat?1:0)},s.toggleStreamerSeat=function(){s.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{streamerSeat:!e.streamerSeat})}))},s.canStartGame=function(){var e,t;return(null===(e=s.props.game)||void 0===e?void 0:e["Max players"])>=s.playerCount()&&(null===(t=s.props.game)||void 0===t?void 0:t["Min players"])<=s.playerCount()},s.onUndoState=function(e){e||(e=Object(p.a)({},s.state.undoState)),s.setState((function(t){return Object(p.a)({},e)}))},s.startGame=function(){var e=Object(p.a)({},s.state);s.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{undoState:Object(p.a)({},e),interested:[],playing:[],joined:[],roomCode:null})})),s.props.startGame(e)},s.initRandomizePlayersAnimation=function(){Math.min(s.props.game["Max players"]-s.playerCount(),s.state.interested.length)>0&&(s.randInt=setInterval(s.randomizePlayersAnimation,50))},s.randomizePlayersAnimation=function(){if(15===s.state.randCount)s.randomizePlayers(),clearInterval(s.randInt),s.setState({randCount:0});else s.setState((function(e){return{randCount:e.randCount+1}}))},s.randomizePlayers=function(){for(var e,t,a=Math.min(s.props.game["Max players"]-s.playerCount(),s.state.interested.length),n=[],r=[],o=s.state.playing;n.length<a;)e=Math.floor(Math.random()*s.state.interested.length),n.includes(e)||(n.push(e),t=s.state.interested[e].username,r.push(t),o=[].concat(Object(m.a)(o),[s.state.interested[e]]));s.setState((function(e){return{interested:e.interested.filter((function(e){return!r.includes(e.username)})),playing:o}}))},s.renderPlayerCard=function(e,t,a){var n,r;if(s.props.userLookup&&s.props.userLookup[null===(n=e)||void 0===n?void 0:n.username]){var o=s.props.userLookup[e.username];e=Object.assign({},e,o)}var i,c,d,u,m=(null===(r=s.props.settings)||void 0===r?void 0:r.enableRoomCode)&&null!=s.state.roomCode;"playing"!==a&&(i=Object(N.jsx)("button",{className:"change-col",onClick:s.updateColumnForUser.bind(Object(l.a)(s),e,"playing"),children:"Playing"})),"interested"!==a&&(c=Object(N.jsx)("button",{className:"change-col",onClick:s.updateColumnForUser.bind(Object(l.a)(s),e,"interested"),children:"Interested"})),"playing"===a&&m&&(d=Object(N.jsx)("button",{className:"change-col send-code",onClick:s.sendCode.bind(Object(l.a)(s),e),children:"Send Code"})),!0===e.isPrioritySeat&&(u=Object(N.jsx)("img",{src:oe,alt:"Priority seat redemption"}));var h={maxWidth:s.state.columnWidth-25};return Object(N.jsxs)("div",{className:"player-card lh-sm fs-5",children:[Object(N.jsxs)("div",{className:"player-card-username",children:[u,Object(N.jsx)("p",{className:"player-name",style:h,children:e.username})]}),Object(N.jsxs)("div",{className:"change-col-buttons-container",children:[d,c,i,Object(N.jsx)("button",{className:"change-col",onClick:s.removeUser.bind(Object(l.a)(s),e.username),children:"X"})]})]},t)},s.renderStreamerSeatToggle=function(){return Object(N.jsxs)("div",{className:"toggle-streamer-seat card-header-item",children:[Object(N.jsx)("label",{className:"toggle-label form-check-label",htmlFor:"reserve-seat-for-streamer",children:"Reserve seat for streamer?"}),Object(N.jsx)("div",{className:"form-check form-switch",children:Object(N.jsx)("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"reserve-seat-for-streamer",defaultChecked:s.state.streamerSeat,onChange:s.toggleStreamerSeat})})]})},s.renderPlayerCount=function(){var e,t,a="player-count";return(null===(e=s.props.game)||void 0===e?void 0:e["Max players"])<s.playerCount()&&(a+=" overlimit"),Object(N.jsxs)("div",{className:a,children:[s.playerCount()," of ",null===(t=s.props.game)||void 0===t?void 0:t["Max players"]," seats claimed"]})},s.sendCode=function(e){var t={id:e["user-id"],username:e.username};return s.props.sendWhisper(t,s.state.roomCode)},s.sendCodeToAll=function(){if(s.state.roomCode){if(0!==s.state.playing.length){var e="Sending room code to";return 1===s.state.playing.length?s.props.sendMessage("".concat(e," 1 person")):s.props.sendMessage("".concat(e," ").concat(s.state.playing.length," people")),s.state.playing.forEach((function(e,t){!function(e,t,a,n){setTimeout((function(){var e=n.userLookup[null===t||void 0===t?void 0:t.username]||{};return n.sendWhisper({id:e["user-id"],username:t.username},a)}),1e3*(e+1))}(t,e,s.state.roomCode,s.props)}))}s.props.sendMessage("Sorry, can't send the code to 0 players. :p")}},s.firstColumn=u.a.createRef(),s.state={interested:[],playing:[],joined:[],roomCode:null,sentCodeStatus:{},streamerSeat:!1,isQueueOpen:!0,randCount:0},s.randInt=0,s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){-1!==window.location.hash.indexOf("fakestate=true")&&this.setState(se),this.updateColumnSizes(),window.addEventListener("resize",this.updateColumnSizes)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateColumnSizes),clearInterval(this.randInt)}},{key:"render",value:function(){var e,t,a,n,s,r=this,o="btn btn-sm start-game";return this.playerCount()<(null===(e=this.props.game)||void 0===e?void 0:e["Min players"])&&(o+=" disabled"),this.state.playing.length>0&&null!==(t=this.props.settings)&&void 0!==t&&t.enableRoomCode&&(s=Object(N.jsxs)("div",{className:"input-group input-group-sm",children:[Object(N.jsx)("input",{type:"password",name:"room-code",value:this.state.roomCode||"",size:"5",autoComplete:"new-password","aria-autocomplete":"none","aria-describedby":"room-code-label",className:"form-control room-code py-0",onChange:this.handleRoomCodeChange,onFocus:this.handleRoomCodeFocus,placeholder:"Code",title:"Paste Room Code Here"}),Object(N.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:this.sendCodeToAll,title:"Send Code to All Players",children:"\u2794"})]})),Object(N.jsxs)("div",{className:"card player-select-container rand-".concat(this.state.randCount),children:[Object(N.jsxs)("div",{className:"card-header d-flex justify-content-between",children:[this.renderStreamerSeatToggle(),Object(N.jsxs)("div",{className:"fs-2 lh-sm game-name",children:[Object(N.jsx)("b",{children:null!==(a=null===(n=this.props.game)||void 0===n?void 0:n.name)&&void 0!==a?a:"TBD"}),this.renderPlayerCount()]}),Object(N.jsxs)("div",{className:"card-header-item d-flex align-items-center align-self-center flex-column",children:[s,Object(N.jsx)("button",{className:o,onClick:this.startGame,disabled:!this.canStartGame(),children:"Start Game"})]})]}),Object(N.jsxs)("div",{className:"card-body player-card-container",children:[Object(N.jsxs)("div",{ref:this.firstColumn,className:"player-card-column interested",children:[Object(N.jsx)("p",{className:"player-card-column-header",children:"Interested"}),this.state.interested.filter((function(e){return e.isPrioritySeat})).map((function(e,t){return r.renderPlayerCard(e,t,"interested")})),this.state.interested.filter((function(e){return!e.isPrioritySeat})).map((function(e,t){return r.renderPlayerCard(e,t,"interested")}))]}),Object(N.jsxs)("div",{className:"player-card-column playing",children:[Object(N.jsxs)("p",{className:"player-card-column-header",children:["Playing",Object(N.jsx)("button",{className:"dice",onClick:this.initRandomizePlayersAnimation,children:Object(N.jsx)("img",{src:re,alt:"dice icon"})})]}),this.state.playing.filter((function(e){return e.isPrioritySeat})).map((function(e,t){return r.renderPlayerCard(e,t,"playing")})),this.state.playing.filter((function(e){return!e.isPrioritySeat})).map((function(e,t){return r.renderPlayerCard(e,t,"playing")}))]})]})]})}}]),a}(d.Component)),ce=a(105),le=(a(252),function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).getHistoryList=function(e){return 0===e.length?Object(N.jsx)("span",{className:"history-placeholder",children:"No games yet"},"placeholder"):Object(N.jsx)(ce.c,{droppableId:"historyList",children:function(t){return Object(N.jsxs)("span",Object(p.a)(Object(p.a)({className:"historyList"},t.droppableProps),{},{ref:t.innerRef,children:[e.map((function(e,t){e.name;var a=e.time;return Object(N.jsx)(ce.b,{draggableId:"".concat(a),index:t,children:function(e){return Object(N.jsx)("li",Object(p.a)(Object(p.a)(Object(p.a)({ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:s.printGame(t)}))}},"".concat(a))})),t.placeholder]}))}})},s.getNextGameName=function(){return s.hasNextGame()?s.props.history[s.props.nextGameIdx].name:"not yet decided"},s.getNextGamePartyPack=function(){return s.hasNextGame()?s.props.history[s.props.nextGameIdx].partyPack:null},s.handleOnDragEnd=function(e){if(e.destination){var t=Array.from(s.props.history).fill();t[s.props.nextGameIdx]=!0;var a=t.splice(e.source.index,1),n=Object(w.a)(a,1)[0];t.splice(e.destination.index,0,n);var r=t.findIndex((function(e){return e})),o=Array.from(s.props.history),i=o.splice(e.source.index,1),c=Object(w.a)(i,1)[0];o.splice(e.destination.index,0,c),s.props.changeGameOrder(o,r)}},s.hasNextGame=function(){return s.props.history.length>s.props.nextGameIdx},s.moveNextGameFwd=function(){return s.props.changeNextGameIdx(1)},s.moveNextGameBack=function(){return s.props.changeNextGameIdx(-1)},s.removeSelectedGameFromHistory=function(){return s.props.removeSelectedGameFromHistory()},s.printGame=function(e){return e===s.props.nextGameIdx?Object(N.jsx)("b",{children:s.props.history[e].name}):s.props.history[e].name},s.state={index:0},s.getHistoryList=s.getHistoryList.bind(Object(l.a)(s)),s.getNextGameName=s.getNextGameName.bind(Object(l.a)(s)),s.getNextGamePartyPack=s.getNextGamePartyPack.bind(Object(l.a)(s)),s.hasNextGame=s.hasNextGame.bind(Object(l.a)(s)),s.moveNextGameBack=s.moveNextGameBack.bind(Object(l.a)(s)),s.moveNextGameFwd=s.moveNextGameFwd.bind(Object(l.a)(s)),s.printGame=s.printGame.bind(Object(l.a)(s)),s}return Object(s.a)(a,[{key:"render",value:function(){var e,t=this.hasNextGame();switch(this.props.requestMode){case"game":e=Object(N.jsx)("button",{id:"sidebar-up-next",className:"open-seat-requests",disabled:!t,onClick:this.props.togglePlayerSelect,children:"OPEN SEAT REQUESTS"});break;case"seat":e=Object(N.jsx)("button",{id:"sidebar-up-next",className:"return-to-wheel",onClick:this.props.togglePlayerSelect,children:"RETURN TO WHEEL"})}return Object(N.jsxs)("div",{id:"sidebar",className:this.props.requestMode,children:[Object(N.jsxs)("div",{className:"card sidebar-panel",children:[Object(N.jsx)("div",{className:"card-header fw-bolder",children:"Up Next"}),Object(N.jsxs)("div",{className:"card-body sidebar-up-next-panel",children:[Object(N.jsxs)("h5",{className:"card-title mb-2 fw-bolder",children:[Object(N.jsx)("button",{className:"cancel-game",onClick:this.removeSelectedGameFromHistory,children:"X"}),this.getNextGameName()]}),Object(N.jsx)("div",{className:"card-subtitle mb-2 fs-7 fst-italic text-light",style:{"--bs-text-opacity":"0.75"},children:this.getNextGamePartyPack()}),e]})]}),Object(N.jsxs)("div",{className:"nav-wrapper py-2",children:[Object(N.jsx)("button",{className:"btn-sm move-next-game-back",onClick:this.moveNextGameBack,children:" \u21e6 "}),Object(N.jsx)("button",{className:"btn-sm move-next-game-fwd",onClick:this.moveNextGameFwd,children:" \u21e8 "})]}),Object(N.jsx)("div",{className:"card sidebar-panel",children:Object(N.jsxs)(ce.a,{onDragEnd:this.handleOnDragEnd,children:[Object(N.jsx)("div",{className:"card-header fw-bolder",children:"History"}),Object(N.jsx)("div",{className:"card-body sidebar-history-list-panel",children:this.getHistoryList(this.props.history)})]})})]})}}]),a}(d.Component)),de=function(e){var t=e.segments,a=e.segColors,n=e.winningSegment,s=e.onStart,r=void 0===s?function(){}:s,o=e.onSpinProgress,i=e.onFinished,c=e.primaryColor,l=e.contrastColor,u=e.buttonText,m=e.isOnlyOnce,h=void 0===m||m,p=e.size,b=void 0===p?290:p,g=e.upDuration,f=void 0===g?100:g,j=e.downDuration,v=void 0===j?1e3:j,O=e.fontFamily,y=void 0===O?"proxima-nova":O,k=e.wheelHeight,x=void 0===k?720:k,S=e.wheelWidth,P=void 0===S?600:S,M=e.enableScrollTop,C=void 0===M||M,G=e.multilineDelimiter,_=void 0===G?null:G,R="",T="",q=!1,L=Object(d.useState)(!1),I=Object(w.a)(L,2),A=I[0],D=I[1],E=0,H=t.length/2,U=0,W=0,F=null,V=Math.PI/"".concat(t.length)*4,B=t.length*f,Q=t.length*v,z=0,J=0,K=Math.round(P/2),Y=Math.round(x/2.5);Object(d.useEffect)((function(){X(),C&&setTimeout((function(){window.scrollTo(0,1)}),0)}),[]);var X=function(){Z(),te()},Z=function(){var e=document.getElementById("canvas");-1!==navigator.appVersion.indexOf("MSIE")&&((e=document.createElement("canvas")).setAttribute("width",P),e.setAttribute("height",x),e.setAttribute("id","canvas"),document.getElementById("wheel").appendChild(e)),e.addEventListener("click",$,!1),F=e.getContext("2d")},$=function(e){q=!0,0===E&&(z=(new Date).getTime(),V=Math.max(.4,Math.PI/t.length),J=0,E=setInterval(ee,H)),console.log({maxSpeed:V}),r()},ee=function(){J++,ae();var e=(new Date).getTime()-z,a=0,s=!1;for(e<B?(a=e/B,W=V*Math.sin(a*Math.PI/2)):(n&&R===n&&J>t.length?(a=e/B,W=V*Math.sin(a*Math.PI/2+Math.PI/2),a=1):(a=e/Q,W=V*Math.sin(a*Math.PI/2+Math.PI/2)),a>=1&&(s=!0)),U+=W;U>=2*Math.PI;)U-=2*Math.PI;s&&(D(!0),i(R),clearInterval(E),E=0,W=0),o&&o({finished:s,progress:a,frames:J})},te=function(){oe(),se(),re()},ae=function(){oe(),se(),re()},ne=function(e,n,s){var r=F,o=t[e];r.save(),r.beginPath(),r.moveTo(K,Y),r.arc(K,Y,b,n,s,!1),r.lineTo(K,Y),r.closePath(),r.fillStyle=a[e],r.fill(),r.stroke(),r.save(),r.translate(K,Y),r.rotate((n+s)/2),r.fillStyle=l||"white",r.font="bold 1em "+y,_&&-1!==o.indexOf(_)?(r.fillText(o.substr(0,o.indexOf(_)),b/2+25,-3),r.font="0.75em "+y,r.fillText(o.substr(o.indexOf(_)+1,21),b/2+25,11)):r.fillText(o.substr(0,21),b/2+25,0),r.restore()},se=function(){var e=F,a=U,n=t.length,s=2*Math.PI;e.lineWidth=1,e.strokeStyle=c||"black",e.textBaseline="middle",e.textAlign="center",e.font="1em "+y;for(var r=1;r<=n;r++){var o=s*(r/n)+U;ne(r-1,a,o),a=o}e.beginPath(),e.arc(K,Y,50,0,s,!1),e.closePath(),e.fillStyle=c||"black",e.lineWidth=10,e.strokeStyle=l||"white",e.fill(),e.font="bold 1em "+y,e.fillStyle=l||"white",e.textAlign="center",e.fillText(u||"Spin",K,Y+3),e.stroke(),e.beginPath(),e.arc(K,Y,b,0,s,!1),e.closePath(),e.lineWidth=10,e.strokeStyle=c||"black",e.stroke()},re=function(){var e=F;e.lineWidth=1,e.strokeStyle=l||"white",e.fileStyle=l||"white",e.beginPath(),e.moveTo(K+20,Y-50),e.lineTo(K-20,Y-50),e.lineTo(K,Y-70),e.closePath(),e.fill();var a=U+Math.PI/2,n=t.length-Math.floor(a/(2*Math.PI)*t.length)-1;n<0&&(n+=t.length),e.textAlign="center",e.textBaseline="middle",e.fillStyle=c||"black",e.font="bold 1.5em "+y,R=t[n],T=R||"",q&&e.fillText(T,K+10,Y+b+50)},oe=function(){F.clearRect(0,0,P,x)},ie="auto";return A&&h&&(ie="none"),Object(N.jsx)("div",{id:"wheel",style:{position:"relative"},children:Object(N.jsx)("canvas",{id:"canvas",width:P,height:x,style:{pointerEvents:ie}})})},ue=(a(256),a(257)),me=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;Object(n.a)(this,a),(s=t.call(this,e)).onMount=function(){-1!==window.location.hash.indexOf("fakestate=true")&&(-1!==window.location.hash.indexOf("playerselect=true")?s.setState(Object.assign({},ne,{showPlayerSelect:!0})):s.setState(ne))},s.changeNextGameIdx=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return!(s.state.nextGameIdx+e>s.state.history.length)&&(!(s.state.nextGameIdx+e<0)&&(s.setState((function(t){return{nextGameIdx:t.nextGameIdx+e}})),!0))},s.changeGameOrder=function(e,t){return!(t>e.length)&&(s.setState({history:e,nextGameIdx:t}),!0)},s.moveNextGameFwd=function(){return s.changeNextGameIdx()},s.moveNextGameBack=function(){return s.changeNextGameIdx(-1)},s.addGameRequest=function(e,t,a){s.setState((function(n){return Object(p.a)(Object(p.a)({},n),{},{messages:Object(p.a)(Object(p.a)({},s.state.messages),{},Object(h.a)({},e.longName,Object(p.a)(Object(p.a)({},e),{},{username:t,isSubRequest:a,time:Date.now(),locked:!1,chosen:!1}))),counter:s.state.counter+1})}))},s.toggleLock=function(e){var t=Object(p.a)({},s.state.messages[e]);t.locked=!t.locked,s.setState((function(){return Object(p.a)(Object(p.a)({},s.state),{},{messages:Object(p.a)(Object(p.a)({},s.state.messages),{},Object(h.a)({},e,t))})}))},s.setNextGame=function(e){for(var t=s.state.nextGameIdx;t<s.state.history.length&&null!==(a=s.state.history[t])&&void 0!==a&&a.override;){var a;t++}return s.setState((function(a){return Object(p.a)(Object(p.a)({},a),{},{history:[].concat(Object(m.a)(a.history.slice(0,Math.max(0,t))),[Object(p.a)(Object(p.a)({},e),{},{override:!0,time:Date.now()})],Object(m.a)(a.history.slice(t)))})})),t-s.state.nextGameIdx},s.addGameToQueue=function(e){s.setState((function(t){return Object(p.a)(Object(p.a)({},t),{},{gameSelected:e,history:[].concat(Object(m.a)(s.state.history),[Object(p.a)(Object(p.a)({},e),{},{override:!1})]),messages:Object(p.a)(Object(p.a)({},t.messages),{},Object(h.a)({},e.longName,Object(p.a)(Object(p.a)({},t.messages[e.longName]),{},{chosen:!0})))})}))},s.clearModal=function(){s.setState({gameSelected:null})},s.getGamesList=function(){var e,t;return{allowedGames:null===(e=s.messageHandler)||void 0===e?void 0:e.state.allowedGames,validGames:null===(t=s.messageHandler)||void 0===t?void 0:t.state.validGames}},s.getOptionsDebugMenu=function(){return[{label:"Load Mock Game Requests",onClick:function(){return s.setState(Object.assign({},ne))}},{label:"Load Mock Game & Player Requests",onClick:function(){return s.setState(Object.assign({},ne,{showPlayerSelect:!0}),(function(){var e;null===(e=s.playerSelector)||void 0===e||e.setState(se)}))}},{label:"Log Debug Environment",onClick:function(){console.log("NODE_ENV:","production"),console.log("REACT_APP_REDIRECT_URI:","https://asukii314.github.io/twitch-request-wheel/%23")}},{label:"Toggle User Message Logging",onClick:function(){return s.toggleUserMessageLogging()}},{label:"-"},{label:"Reconnect to Chat",onClick:function(){return s.refreshTwitchClient()}},{label:"Load Last State",onClick:function(){return s.getLastState()}}]},s.toggleUserMessageLogging=function(){return s.setState((function(e){return{logUserMessages:!e.logUserMessages}}),(function(){var e;return console.log("toggleUserMessageLogging | new state: ",null===(e=s.state.logUserMessages)||void 0===e?void 0:e.toString())}))},s.getLastState=function(){var e=void 0!==Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_REDIRECT_URI_NOENCODE:"https://asukii314.github.io/twitch-request-wheel/#",REACT_APP_TWITCH_CLIENT_ID:"u172q64ekv1j8nxy1r48mb8vn4kk7v",REACT_APP_REDIRECT_URI:"https://asukii314.github.io/twitch-request-wheel/%23",REACT_APP_TWITCH_CLIENT_SECRET:"7yfmbc5ka6t7frki5g8m0qsboltp2p"}).JEST_WORKER_ID;try{var t=localStorage.getItem("__stateMainScreen");t?(t=JSON.parse(t),s.setState((function(e){return Object.assign({},e,Object(p.a)({},t))}),(function(){return console.log("getLastState | resumed state: ")})),e||console.log("Last state loaded!")):e||console.log("Last state not found.")}catch(a){console.log("Error loading last state:",a)}},s.getOptionsMenu=function(){var e;return[{label:"Reload Game List",onClick:null===(e=s.messageHandler)||void 0===e?void 0:e.reloadGameList}]},s.onWheelSpun=function(e){var t,a=null===(t=s.state.messages)||void 0===t?void 0:t[e];if(a){var n=a.username;return s.addGameToQueue(a),s.state.messages[e].locked||setTimeout((function(){s.removeGame(e),s.clearModal()}),4e3),s.chatActivity.getStatusPromise(n).then((function(e){var t="";switch(e){case O:t="/me ".concat(a.name," just won the spin, but it doesn't seem like @").concat(n," is still around. Hope someone else wants to play!");break;case j:t="/me @".concat(n,", good news - ").concat(a.name," just won the spin!");break;default:t="/me @".concat(n,", good news - ").concat(a.name," just won the spin! (I hope you're still around!)")}return s.messageHandler.sendMessage(t)}))}},s.removeGame=function(e){var t=Object(p.a)({},s.state.messages);delete t[e],s.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{messages:t,counter:s.state.counter+1})}))},s.removeSelectedGameFromHistory=function(){var e=s.state,t=e.history,a=e.nextGameIdx;if(!t[a])return!1;var n=t[a];return delete t[a],s.setState({history:t.filter((function(e){return!!e})),nextGameIdx:Math.max(-1,Math.min(a,t.length))}),n},s.onMessage=function(e,t,a){if(s.chatActivity.updateLastMessageTime(t),!s.state.userLookup[t]&&a&&a["user-id"])return s.setState((function(e){return{userLookup:Object.assign({},e.userLookup,Object(h.a)({},t,a))}}))},s.onSettingsUpdate=function(e){var t=s.state.settings;return localStorage.setItem("__settings",JSON.stringify(Object.assign({},t,e))),console.log("Settings saved:",t),s.setState((function(a){return{settings:Object.assign({},t,e)}}))},s.onUndoState=function(){return s.state.showPlayerSelect||(s.togglePlayerSelect(),s.moveNextGameBack()),s.setState({showOptionsMenu:!1},(function(){var e;return null===(e=s.playerSelector)||void 0===e?void 0:e.onUndoState(s.state.undoState)}))},s.toggleAllowGameRequests=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=s.state.allowGameRequests;null!==e&&"object"!==typeof e&&(t=!e),s.setState((function(e){return{allowGameRequests:!t}}))},s.toggleCommandsModal=function(){s.setState((function(e){return{showCommandsModal:!e.showCommandsModal}}))},s.toggleOptionsMenu=function(){s.setState((function(e){return{showOptionsMenu:!e.showOptionsMenu}}))},s.toggleOptionsModal=function(){s.setState((function(e){return{showOptionsModal:!e.showOptionsModal}}))},s.togglePlayerSelect=function(){s.setState((function(e){return{showPlayerSelect:!e.showPlayerSelect}}))},s.refreshTwitchClient=function(){var e;return null===(e=s.messageHandler)||void 0===e?void 0:e.refreshTwitchClient()},s.routePlayRequest=function(e,t){var a,n,r=t.sendConfirmationMsg,o=void 0===r||r,i=t.isPrioritySeat,c=void 0!==i&&i,l=s.state.showPlayerSelect?null===(a=s.playerSelector)||void 0===a?void 0:a.handleNewPlayerRequest(e,{isPrioritySeat:c}):"sign-ups are currently closed; try again after this game wraps up!";o&&(null===(n=s.messageHandler)||void 0===n||n.sendMessage("/me @".concat(e,", ").concat(l)))},s.routeLeaveRequest=function(e){var t;null===(t=s.playerSelector)||void 0===t||t.removeUser(e)},s.routeOpenQueueRequest=function(){var e;s.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{showPlayerSelect:!0})})),null===(e=s.playerSelector)||void 0===e||e.openQueue()},s.routeCloseQueueRequest=function(){var e;null===(e=s.playerSelector)||void 0===e||e.closeQueue()},s.routeClearQueueRequest=function(){var e;null===(e=s.playerSelector)||void 0===e||e.clearQueue()},s.sendMessage=function(e){var t;return null===(t=s.messageHandler)||void 0===t?void 0:t.sendMessage(e)},s.sendWhisper=function(){var e=Object(c.a)(Object(i.a)().mark((function e(t,a){var n,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new URLSearchParams({from_user_id:s.props.id,to_user_id:t.id}),r={message:a},e.next=4,s.props.validateToken();case 4:return e.abrupt("return",fetch("https://api.twitch.tv/helix/whispers?".concat(n),{method:"POST",body:JSON.stringify(r),headers:{Authorization:"Bearer ".concat(s.props.access_token),"Client-ID":"u172q64ekv1j8nxy1r48mb8vn4kk7v","Content-Type":"application/json"}}).then(function(){var e=Object(c.a)(Object(i.a)().mark((function e(a){var n,r,o,c,l;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(204===a.status){e.next=16;break}return o="Error ".concat(a.status," sending to @").concat(t.username),e.prev=2,e.next=5,a.json();case 5:(c=e.sent).error&&(o+=": ".concat(c.error)),c.player=t,console.log({errMsg:o,error:c}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log({errMsg:o,error:e.t0});case 14:return null===(r=s.messageHandler)||void 0===r||r.sendMessage("/me ".concat(o)),e.abrupt("return",Promise.resolve(o));case 16:return l="Code sent to @".concat(t.username),null===(n=s.messageHandler)||void 0===n||n.sendMessage("/me ".concat(l)),e.abrupt("return",Promise.resolve(l));case 19:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var a,n="Error sending to @".concat(t.username,", please check console for details.");return console.log({errMsg:n,error:e}),null===(a=s.messageHandler)||void 0===a||a.sendMessage("/me ".concat(n)),Promise.reject(n)})));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),s.showUndoAvailable=function(){var e=s.state,t=e.history,a=e.lastStartIdx,n=e.lastStartLongName,r=e.lastStartTimestamp;return!(!e.undoState||!a&&0!==a||!n||!r)&&(t.length>0&&t[a].longName===n)},s.startGame=function(e){if(s.state.showPlayerSelect){var t,a;if(!e)e=null===(a=s.playerSelector)||void 0===a?void 0:a.state;var n=s.state.nextGameIdx,r=null===(t=s.state.history[n])||void 0===t?void 0:t.longName;return s.togglePlayerSelect(),s.setState({undoState:e,lastStartIdx:n,lastStartLongName:r,lastStartTimestamp:(new Date).toLocaleString()}),s.moveNextGameFwd(),!0}return!1},s.setMessageHandlerRef=function(e){s.messageHandler=e},s.setPlayerSelectRef=function(e){s.playerSelector=e},s.renderCommandsModal=function(){return Object(N.jsxs)(b.a,{show:s.state.showCommandsModal,onHide:function(){return s.toggleCommandsModal(!1)},fullscreen:!0,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(N.jsx)(b.a.Header,{closeVariant:"white",closeButton:!0,children:Object(N.jsx)(b.a.Title,{id:"contained-modal-title-vcenter",children:"Chat Commands"})}),Object(N.jsx)(b.a.Body,{children:Object(N.jsx)(q,{hideHeader:!0})})]})},s.chatActivity=new y(s.props.channel);var r={},o=void 0!==Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_REDIRECT_URI_NOENCODE:"https://asukii314.github.io/twitch-request-wheel/#",REACT_APP_TWITCH_CLIENT_ID:"u172q64ekv1j8nxy1r48mb8vn4kk7v",REACT_APP_REDIRECT_URI:"https://asukii314.github.io/twitch-request-wheel/%23",REACT_APP_TWITCH_CLIENT_SECRET:"7yfmbc5ka6t7frki5g8m0qsboltp2p"}).JEST_WORKER_ID;try{var d=localStorage.getItem("__settings");d?(r=JSON.parse(d),o||console.log("Saved settings loaded!")):o||console.log("No saved settings detected, using defaults.")}catch(u){console.log("Unable to load or read saved settings, using defaults.")}return s.state={allowGameRequests:!0,gameSelected:null,messages:{},colors:ue({count:99,luminosity:"light",hue:"blue"}),counter:0,history:[],logUserMessages:!1,nextGameIdx:0,settings:r,showCommandsModal:!1,showOptionsMenu:!1,showOptionsModal:!1,showPlayerSelect:!1,userLookup:{}},s.playerSelector=null,s.messageHandler=null,s.changeNextGameIdx=s.changeNextGameIdx.bind(Object(l.a)(s)),s.moveNextGameFwd=s.moveNextGameFwd.bind(Object(l.a)(s)),s.moveNextGameBack=s.moveNextGameBack.bind(Object(l.a)(s)),s.addGameRequest=s.addGameRequest.bind(Object(l.a)(s)),s.toggleLock=s.toggleLock.bind(Object(l.a)(s)),s.setNextGame=s.setNextGame.bind(Object(l.a)(s)),s.addGameToQueue=s.addGameToQueue.bind(Object(l.a)(s)),s.onWheelSpun=s.onWheelSpun.bind(Object(l.a)(s)),s.removeGame=s.removeGame.bind(Object(l.a)(s)),s.onMessage=s.onMessage.bind(Object(l.a)(s)),s.toggleAllowGameRequests=s.toggleAllowGameRequests.bind(Object(l.a)(s)),s.toggleCommandsModal=s.toggleCommandsModal.bind(Object(l.a)(s)),s.togglePlayerSelect=s.togglePlayerSelect.bind(Object(l.a)(s)),s.routePlayRequest=s.routePlayRequest.bind(Object(l.a)(s)),s.routeLeaveRequest=s.routeLeaveRequest.bind(Object(l.a)(s)),s.routeOpenQueueRequest=s.routeOpenQueueRequest.bind(Object(l.a)(s)),s.routeCloseQueueRequest=s.routeCloseQueueRequest.bind(Object(l.a)(s)),s.routeClearQueueRequest=s.routeClearQueueRequest.bind(Object(l.a)(s)),s.startGame=s.startGame.bind(Object(l.a)(s)),s.sendMessage=s.sendMessage.bind(Object(l.a)(s)),s.sendWhisper=s.sendWhisper.bind(Object(l.a)(s)),s.setMessageHandlerRef=s.setMessageHandlerRef.bind(Object(l.a)(s)),s.setPlayerSelectRef=s.setPlayerSelectRef.bind(Object(l.a)(s)),s.toggleUserMessageLogging=s.toggleUserMessageLogging.bind(Object(l.a)(s)),s.getLastState=s.getLastState.bind(Object(l.a)(s)),s.showUndoAvailable=s.showUndoAvailable.bind(Object(l.a)(s)),s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.onMount()}},{key:"componentDidUpdate",value:function(e,t){this.state.history.length===t.history.length&&Object.keys(this.state.messages).length===Object.keys(t.messages).length&&this.state.counter===t.counter||localStorage.setItem("__stateMainScreen",JSON.stringify(this.state))}},{key:"renderGameChosenModal",value:function(e){var t,a=this,n={force:.6,duration:3500,particleCount:100,floorHeight:Math.max(window.outerWidth,window.outerHeight),floorWidth:Math.max(window.outerWidth,window.outerHeight)};return e.username&&(t=Object(N.jsxs)("h4",{children:["requested by @",e.username]})),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"overlay fade-in-out",children:Object(N.jsx)("div",{className:"confetti-wrapper",children:Object(N.jsx)(x.a,Object(p.a)({},n))})}),Object(N.jsxs)("div",{className:"confetti-modal modal-game-chosen fade-in-out",onClick:function(){return a.removeGame(e.longName)},children:[Object(N.jsx)("h1",{children:e.name}),t]})]})}},{key:"renderOptionsModal",value:function(){var e,t=this,a=this.messageHandler.state,n=a.allowedGames,s=a.validGames,r=(e=[]).concat.apply(e,Object(m.a)(Object.entries(s).map((function(e,t){return Object.keys(e[1]).map((function(t){return{id:"".concat(e[0]," ").concat(t).replace(/\W/gi,"_"),game:t,pack:e[0]}}))}))));return console.log("gamePackList:",r,n),Object(N.jsxs)(b.a,{show:this.state.showOptionsModal,onHide:function(){return t.toggleOptionsModal(!1)},size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(N.jsx)(b.a.Header,{closeButton:!0,children:Object(N.jsx)(b.a.Title,{id:"contained-modal-title-vcenter",children:"Options"})}),Object(N.jsxs)(b.a.Body,{children:[Object(N.jsx)("h4",{children:"Options"}),Object(N.jsx)("div",{className:"options-list",children:Object(N.jsx)("ul",{children:r.map((function(e,t){var a=e.id,n=e.game,s=e.pack;return Object(N.jsxs)("li",{children:[Object(N.jsx)("input",{type:"checkbox",id:a,name:a,value:a})," ",Object(N.jsxs)("label",{htmlFor:a,children:[s,": ",n]})]},a)}))})})]}),Object(N.jsx)(b.a.Footer,{children:Object(N.jsx)(g.a,{"data-bs-dismiss":"modal",children:"Close"})})]})}},{key:"render",value:function(){var e,t,a,n=this,s=Object.keys(this.state.messages);this.state.showOptionsModal?a=this.renderOptionsModal():this.state.showCommandsModal?a=this.renderCommandsModal():this.state.gameSelected&&(a=this.renderGameChosenModal(this.state.gameSelected));var r,o,i=this.state.showPlayerSelect?"player-select":"game-select",c=this.state.showPlayerSelect?Object(N.jsxs)("span",{className:"subheading-player fade-in-delay",children:["Type ",Object(N.jsx)("b",{children:"!new"})," in ",this.props.channel,"'s chat if you want to join the next game"]}):Object(N.jsxs)("span",{className:"subheading-game ".concat(!0===this.state.allowGameRequests?"fade-in-delay":"fade-out"),title:"Click to ".concat(!0===this.state.allowGameRequests?"disable":"enable"," game requests."),onClick:this.toggleAllowGameRequests,children:["Type e.g. ",Object(N.jsx)("b",{children:'"!request Blather Round"'})," in ",this.props.channel,"'s chat to add"]});if(this.state.showPlayerSelect){var l;r=Object(N.jsx)(ie,{game:null===(l=this.state.history)||void 0===l?void 0:l[this.state.nextGameIdx],sendMessage:this.sendMessage,sendWhisper:this.sendWhisper,settings:this.state.settings,startGame:this.startGame,ref:this.setPlayerSelectRef,userLookup:this.state.userLookup})}else{r=s.map((function(e,t){return Object(N.jsx)(D,{gameName:e,metadata:n.state.messages[e],onDelete:n.removeGame,toggleLock:n.toggleLock.bind(e),getActivity:n.chatActivity.getStatusPromise},t)}));var d=s.length<5?100:500/s.length,u=s.length<5?1e3:5e3/s.length;o=Object(N.jsx)("div",{className:"right-column",width:"50px",children:Object(N.jsx)("div",{className:"wheel-wrapper fade-in",children:Object(N.jsx)(de,{segments:s,segColors:this.state.colors,onFinished:this.onWheelSpun,isOnlyOnce:!1,size:250,upDuration:d,downDuration:u,primaryColor:"white",contrastColor:"black",fontFamily:"Arial",multilineDelimiter:" ("},this.state.counter)})})}var m=this.getGamesList();return Object(N.jsxs)("div",{className:"main-screen-wrapper",children:[Object(N.jsx)("nav",{className:"main-screen-nav navbar-dark",children:Object(N.jsx)("button",{className:"btn btn-toggle-options float-end navbar-toggler",type:"button",onClick:this.toggleOptionsMenu,children:Object(N.jsx)("span",{className:"navbar-toggler-icon"})})}),Object(N.jsxs)("div",{id:"main-screen",className:i,children:[Object(N.jsx)(K,{access_token:this.props.access_token,addGameRequest:this.addGameRequest,allowGameRequests:this.state.allowGameRequests,caniplayHandler:this.routePlayRequest,changeNextGameIdx:this.changeNextGameIdx,channel:this.props.channel,clearQueueHandler:this.routeClearQueueRequest,closeQueueHandler:this.routeCloseQueueRequest,logUserMessages:this.state.logUserMessages,messages:this.state.messages,modList:this.props.modList,onDelete:this.removeGame,onMessage:this.onMessage,openQueueHandler:this.routeOpenQueueRequest,playerExitHandler:this.routeLeaveRequest,previousGames:this.state.history.slice(0,this.state.nextGameIdx),ref:this.setMessageHandlerRef,removeSelectedGameFromHistory:this.removeSelectedGameFromHistory,setNextGame:this.setNextGame,settings:this.state.settings,onSettingsUpdate:this.onSettingsUpdate,startGame:this.startGame,toggleAllowGameRequests:this.toggleAllowGameRequests,undoStart:this.onUndoState,upcomingGames:this.state.history.slice(this.state.nextGameIdx)}),Object(N.jsxs)("div",{className:"left-column fade-in",children:[Object(N.jsx)("h1",{children:this.state.showPlayerSelect?"Seat Requests":"Game Requests"}),Object(N.jsx)("h4",{children:c}),Object(N.jsxs)("div",{className:"left-column-body",children:[Object(N.jsx)(le,{changeGameOrder:this.changeGameOrder,parentState:this.state,history:this.state.history,nextGameIdx:this.state.nextGameIdx,changeNextGameIdx:this.changeNextGameIdx,moveNextGameFwd:this.moveNextGameFwd,moveNextGameBack:this.moveNextGameBack,togglePlayerSelect:this.togglePlayerSelect,requestMode:this.state.showPlayerSelect?"seat":"game",removeSelectedGameFromHistory:this.removeSelectedGameFromHistory}),Object(N.jsx)("div",{className:"left-column-inner-body",children:r})]})]}),o,a,Object(N.jsx)(ae,{gamesList:m,onUndo:this.onUndoState,parentState:this.state,debugItems:this.getOptionsDebugMenu(),items:this.getOptionsMenu(),reloadGameList:null===(e=this.messageHandler)||void 0===e?void 0:e.reloadGameList,refreshTwitchClient:null===(t=this.messageHandler)||void 0===t?void 0:t.refreshTwitchClient,onHide:this.toggleOptionsMenu,onLogout:this.props.onLogout,onSettingsUpdate:this.onSettingsUpdate,settings:this.state.settings,toggleCommandsModal:this.toggleCommandsModal,showOptionsMenu:this.state.showOptionsMenu,showUndoAvailable:this.showUndoAvailable()})]})]})}}]),a}(d.Component);a(258);var he=function(e){return Object(N.jsxs)("div",{className:"lds-ripple",children:[Object(N.jsx)("div",{}),Object(N.jsx)("div",{})]})},pe=a(23),be=a(133),ge=a.n(be),fe=a(51),je=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).promisedSetState=function(t){return new Promise((function(a){return e.setState(t,a)}))},e.state={username:localStorage.getItem("__username"),user_id:localStorage.getItem("__user_id"),access_token:localStorage.getItem("__access_token"),expires_in:localStorage.getItem("__expires_in")||0,expiry_time:localStorage.getItem("__expiry_time")||0,refresh_token:localStorage.getItem("__refresh_token"),failed_login:!1},e.getAuth=e.getAuth.bind(Object(l.a)(e)),e.getUsers=e.getUsers.bind(Object(l.a)(e)),e.logOut=e.logOut.bind(Object(l.a)(e)),e.onAuthenticated=e.onAuthenticated.bind(Object(l.a)(e)),e.promisedSetState=e.promisedSetState.bind(Object(l.a)(e)),e.refreshToken=e.refreshToken.bind(Object(l.a)(e)),e.validateToken=e.validateToken.bind(Object(l.a)(e)),e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;return this._isMounted=!0,this.state.access_token?this.getUsers(this.state.access_token).catch((function(t){return console.error(t),e.getAuth(t)})):this.getAuth()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"getAuth",value:function(){var e=Object(c.a)(Object(i.a)().mark((function e(t){var a,n,s=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&console.error(t),localStorage.removeItem("__username"),localStorage.removeItem("__user_id"),localStorage.removeItem("__access_token"),localStorage.removeItem("__expires_in"),localStorage.removeItem("__expiry_time"),localStorage.removeItem("__refresh_token"),a=ge.a.parse(this.props.location.search),n=new URLSearchParams({grant_type:"authorization_code",code:a.code,client_id:"u172q64ekv1j8nxy1r48mb8vn4kk7v",client_secret:"7yfmbc5ka6t7frki5g8m0qsboltp2p",redirect_uri:"https://asukii314.github.io/twitch-request-wheel/#"}),e.next=11,fe("https://id.twitch.tv/oauth2/token?".concat(n),{method:"POST",headers:{Accept:"application/vnd.twitchtv.v5+json"}}).then((function(e){return e.json()})).then((function(e){if(s._isMounted)return e.access_token?s.onAuthenticated(e):s.setState({failed_login:!0})})).catch((function(e){if(console.error(e),s._isMounted)return s.setState({failed_login:!0})}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUsers",value:function(e){var t=this;return fe("https://api.twitch.tv/helix/users",{headers:{"Client-ID":"u172q64ekv1j8nxy1r48mb8vn4kk7v",Authorization:"Bearer ".concat(this.state.access_token)}}).then((function(e){return e.json()})).then((function(a){return localStorage.setItem("__username",a.data[0].login),localStorage.setItem("__user_id",a.data[0].id),fe("https://api.twitch.tv/helix/moderation/moderators?broadcaster_id=".concat(a.data[0].id),{headers:{"Client-ID":"u172q64ekv1j8nxy1r48mb8vn4kk7v",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then(function(){var e=Object(c.a)(Object(i.a)().mark((function e(n){var s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n.data?n.data.map((function(e){return e.user_name?e.user_name.toLowerCase():null})).filter((function(e){return e})):null,!t._isMounted){e.next=3;break}return e.abrupt("return",t.promisedSetState({username:a.data[0].login,user_id:a.data[0].id,modList:s}));case 3:return e.abrupt("return");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}},{key:"logOut",value:function(){localStorage.removeItem("__username"),localStorage.removeItem("__user_id"),localStorage.removeItem("__access_token"),localStorage.removeItem("__expires_in"),localStorage.removeItem("__expiry_time"),localStorage.removeItem("__refresh_token");var e=new URLSearchParams({client_id:"u172q64ekv1j8nxy1r48mb8vn4kk7v",token:this.state.access_token,redirect_uri:"https://asukii314.github.io/twitch-request-wheel/#"});return fe("https://id.twitch.tv/oauth2/revoke?".concat(e),{method:"POST",headers:{Accept:"application/vnd.twitchtv.v5+json"}}).then((function(){return window.location.reload()}))}},{key:"onAuthenticated",value:function(e){var t=Date.now()+e.expires_in;return localStorage.setItem("__access_token",e.access_token),localStorage.setItem("__expires_in",e.expires_in),localStorage.setItem("__expiry_time",t),localStorage.setItem("__refresh_token",e.refresh_token),this.setState({access_token:e.access_token,expires_in:e.expires_in,expiry_time:t,refresh_token:e.refresh_token}),this.getUsers(e.access_token)}},{key:"refreshToken",value:function(){var e=Object(c.a)(Object(i.a)().mark((function e(){var t,a,n=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("refreshToken"),t=this.state.refresh_token,a=new URLSearchParams({grant_type:"refresh_token",client_id:"u172q64ekv1j8nxy1r48mb8vn4kk7v",client_secret:"7yfmbc5ka6t7frki5g8m0qsboltp2p",refresh_token:t}),e.next=5,fe("https://id.twitch.tv/oauth2/token?".concat(a),{method:"POST",headers:{Authorization:"OAuth ".concat(t),"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){return e.json()})).then(this.onAuthenticated).catch((function(e){return console.error(e),n.logOut()}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"validateToken",value:function(){var e=Object(c.a)(Object(i.a)().mark((function e(t){var a=this;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t=this.state.access_token),e.next=3,fe("https://id.twitch.tv/oauth2/validate",{method:"GET",headers:{Authorization:"OAuth ".concat(t)}}).then((function(e){return e.json()})).then((function(e){return 401===e.status?(console.log("calling this.refreshToken();..."),a.refreshToken()):Promise.resolve()})).catch((function(e){if(console.error(e),401===e.status)return console.log("calling this.refreshToken();..."),a.refreshToken()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(this.state.failed_login)return Object(N.jsx)(pe.a,{to:"/login"});var e=Object(N.jsxs)("h2",{children:[Object(N.jsx)(he,{}),Object(N.jsx)("br",{}),"Loading..."]});return this.state.username&&this.state.modList&&(e=Object(N.jsx)(me,{channel:this.state.username,id:this.state.user_id,modList:this.state.modList,access_token:this.state.access_token,onLogout:this.logOut,validateToken:this.validateToken})),Object(N.jsx)("div",{id:["authenticated-app"].join(" "),children:e})}}]),a}(d.Component),ve=Object(pe.g)(je),Oe=a(73),ye=(a(263),a(51)),ke=function(e){var t=Object.keys(e.metadata);return Object(N.jsxs)("div",{className:"partyPackCard",children:[Object(N.jsxs)("p",{className:"partyPackName",children:[e.partyPackName," "]}),t.map((function(t,a){var n,s;return Object(N.jsx)(xe,{gameName:t,possibleMatches:null===(n=e.metadata)||void 0===n||null===(s=n[t])||void 0===s?void 0:s.Variants},a)}))]})},xe=function(e){return Object(N.jsxs)("div",{className:"mt-2 lh-sm",children:[Object(N.jsxs)("p",{className:"gameName",children:[e.gameName," "]}),e.possibleMatches.map((function(t,a){return Object(N.jsxs)("li",{className:"possibleGameMatch",children:["!request ",t]},"".concat(e.gameName,"-").concat(a))}))]})},we=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).state={validGames:[]},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(e){var t=this;ye(W).then((function(e){return e.text()})).then((function(e){t.setState((function(t){return Object(p.a)(Object(p.a)({},t),{},{validGames:P.a.parse(e)})}))}))}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.validGames);return Object(N.jsx)("div",{className:"partyPackList",children:t.map((function(t,a){return Object(N.jsx)(ke,{partyPackName:t,metadata:e.state.validGames[t]},a)}))})}}]),a}(d.Component),Se=(a(264),"https://id.twitch.tv/oauth2/authorize"+"?client_id=".concat("u172q64ekv1j8nxy1r48mb8vn4kk7v")+"&response_type=code&scope=".concat("chat:read chat:edit moderation:read user:manage:whispers")+"&redirect_uri=".concat("https://asukii314.github.io/twitch-request-wheel/%23")),Pe=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(N.jsxs)("div",{id:"login-screen",className:"fade-in",children:[Object(N.jsx)("h1",{children:"Twitch Request Wheel"}),Object(N.jsx)("hr",{}),Object(N.jsxs)("a",{href:Se,className:"btn btn-sm fs-2",children:["Log In With ",Object(N.jsx)("strong",{children:"Twitch"})]}),Object(N.jsx)("br",{}),Object(N.jsx)("small",{children:"v".concat(F.a)})]})}}]),a}(d.Component),Me=Pe,Ce=(a(265),a(51)),Ge=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).getAllowedGames=function(e){var t,a=localStorage.getItem("__allowedGames"),n=a?JSON.parse(a):{};return Object.assign.apply(Object,[{}].concat(Object(m.a)((t=[]).concat.apply(t,Object(m.a)(Object.entries(e).map((function(e){var t=Object(w.a)(e,2),a=t[0],s=t[1];return Object.assign.apply(Object,[{}].concat(Object(m.a)(Object.keys(s).map((function(e){var t="".concat(a," ").concat(e).replace(/\W/gi,"_");return t in n&&void 0!==n[t].id?Object(h.a)({},t,n[t]):Object(h.a)({},t,{id:t,game:e,pack:a,enabled:!0})})))))})))))))},s.setAllowedGames=function(e){var t=this.getAllowedGames(e);this.setState({allowedGames:t,validGames:e}),localStorage.setItem("__allowedGames",JSON.stringify(t))},s.onCheckHandler=function(e){var t=e.target,a=t.id,n=t.checked;s.setState((function(e){return{allowedGames:Object(p.a)(Object(p.a)({},e.allowedGames),{},Object(h.a)({},a,Object(p.a)(Object(p.a)({},e.allowedGames[a]),{},{enabled:n})))}}))},s.onGroupCheckHandler=function(e){var t=e.target,a=t.value,n=t.checked,r=Object.values(s.state.allowedGames).filter((function(e){return e.pack===a}));s.setState((function(e){return{allowedGames:Object(p.a)(Object(p.a)({},e.allowedGames),Object.assign.apply(Object,Object(m.a)(r.map((function(e){return Object(h.a)({},e.id,Object(p.a)(Object(p.a)({},e),{},{enabled:n}))})))))}}))},s.renderGameCard=function(e){var t,a=e.id,n=e.game,s=e.pack,r=(null===(t=this.state.allowedGames[a])||void 0===t?void 0:t.enabled)||!1;return Object(N.jsxs)("li",{className:"gameName",children:[Object(N.jsx)("input",{type:"checkbox",id:a,name:a,value:a,checked:r,onChange:this.onCheckHandler})," ",Object(N.jsx)("label",{htmlFor:a,title:"".concat(s,": ").concat(n),children:n})]},a)},s.renderPackCheckbox=function(e){var t=Object.values(this.state.allowedGames).filter((function(t){return t.pack===e})),a=t.filter((function(e){return!0===e.enabled})).length===t.length;return Object(N.jsx)("input",{type:"checkbox",id:e,name:e,value:e,checked:a,onChange:this.onGroupCheckHandler})},s.renderPartyPack=function(e){var t=this,a=Object.keys(e.metadata),n=Object.values(this.state.allowedGames).filter((function(t){return t.pack===e.partyPackName})),s=n.filter((function(e){return!0===e.enabled})),r=s.length===n.length,o=!r&&0!==s.length;return Object(N.jsxs)("div",{className:"partyPackCard",children:[Object(N.jsxs)("p",{className:"partyPackName",children:[e.partyPackName," ",Object(N.jsx)("input",{type:"checkbox",id:e.partyPackName,name:e.partyPackName,value:e.partyPackName,checked:r,onChange:this.onGroupCheckHandler,ref:function(e){return e&&(e.indeterminate=o)}})]}),Object(N.jsx)("ul",{className:"partyPackGameList",children:a.map((function(a,n){return t.renderGameCard({game:a,id:"".concat(e.partyPackName," ").concat(a).replace(/\W/gi,"_"),pack:e.partyPackName})}))})]},e.key)},s.state={allowedGames:[],validGames:[]},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(e){var t=this;Ce(W).then((function(e){return e.text()})).then((function(e){var a=P.a.parse(e);t.setAllowedGames(a)}))}},{key:"componentDidUpdate",value:function(){this.state.allowedGames&&0!==this.state.validGames.length&&0!==this.state.allowedGames.length&&localStorage.setItem("__allowedGames",JSON.stringify(this.state.allowedGames))}},{key:"render",value:function(){var e=this,t=this.state.validGames,a=Object.keys(t);return Object(N.jsx)("div",{className:"partyPackList",children:a.map((function(t,a){return e.renderPartyPack({key:a,partyPackName:t,metadata:e.state.validGames[t]})}))})}}]),a}(d.Component),Ne=(a(266),a(267),function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).onHashChange=function(){var t=window.location.hash.match(/theme=(.+?)\b/);null!==t&&t[1]!==e.state.theme&&e.setState({theme:t[1]})},e.state={theme:localStorage.getItem("__theme")},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("hashchange",this.onHashChange),this.onHashChange()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("hashchange",this.onHashChange)}},{key:"render",value:function(){var e=["App"];return-1!==window.location.hash.indexOf("commands")&&e.push("justify-content-start"),-1!==window.location.hash.indexOf("legacy=true")&&e.push("legacy"),this.state.theme&&e.push("theme theme-".concat(this.state.theme)),Object(N.jsx)(Oe.b,{basename:"/",children:Object(N.jsx)("div",{className:e.join(" "),children:Object(N.jsxs)(pe.d,{children:[Object(N.jsx)(pe.b,{exact:!0,path:"/login",component:Me}),Object(N.jsx)(pe.b,{exact:!0,path:"/commands",component:q}),Object(N.jsx)(pe.b,{exact:!0,path:"/gamelist",component:we}),Object(N.jsx)(pe.b,{exact:!0,path:"/options",component:Ge}),Object(N.jsx)(pe.b,{path:"/",component:ve})]})})})}}]),a}(d.Component)),_e=a(27),Re=a(53),Te=function(e){e&&e instanceof Function&&(Object(Re.a)(e),Object(Re.c)(e),Object(Re.b)(e),Object(Re.d)(e),Object(Re.e)(e))};a(268);Object(_e.render)(Object(N.jsx)(u.a.StrictMode,{children:Object(N.jsx)(Oe.a,{children:Object(N.jsx)(Ne,{})})}),document.getElementById("root")),Te()},65:function(e){e.exports=JSON.parse('{"a":"0.12.0"}')}},[[270,1,2]]]);
//# sourceMappingURL=main.ab05fcb6.chunk.js.map